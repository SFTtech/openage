<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Openage: openage/convert/pefile.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="banner.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Openage
   </div>
   <div id="projectbrief">Free (as in freedom) open source clone of the Age of Empires II engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pefile_8py_source.xhtml','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pefile.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pefile_8py.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespaceopenage_1_1convert_1_1pefile.xhtml">    1</a></span>&#160;<span class="comment"># Copyright 2013-2017 the openage authors. See copying.md for legal info.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="stringliteral">Provides PEFile, a class for reading MS portable executable files.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="stringliteral">Primary doc sources:</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="stringliteral">http://www.csn.ul.ie/~caolan/pub/winresdump/winresdump/doc/pefile2.html</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral">http://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">from</span> ..util.struct <span class="keyword">import</span> NamedStruct</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">from</span> ..util.filelike.stream <span class="keyword">import</span> StreamFragment</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">class </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml">PEDOSHeader</a>(<a class="code" href="classopenage_1_1util_1_1struct_1_1_named_struct.xhtml">NamedStruct</a>):</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="stringliteral">    The (legacy) DOS-compatible PE header.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="stringliteral">    In all modern PE files, only the &#39;lfanew&#39; pointer is relevant.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml">   22</a></span>&#160;    <span class="comment"># pylint: disable=bad-whitespace,too-few-public-methods</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    endianness = <span class="stringliteral">&quot;&lt;&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#ad339a63e0d9e1bbdcbec102585bedb7f">   26</a></span>&#160;    signature            = <span class="stringliteral">&quot;2s&quot;</span>   <span class="comment"># always &#39;MZ&#39;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    bytes_lastpage       = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># bytes on the last page of file</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a123f18e9688e2306132980e94724655a">   28</a></span>&#160;    count_pages          = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># pages in file</span></div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a873c11c0872caa17df955b8b316f0591">   29</a></span>&#160;    crlc                 = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># relocations</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#ab4b3526b1ac6a75a69d1abd4b317371a">   30</a></span>&#160;    cparhdr              = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># size of header in paragraphs</span></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a59320472bba54a1bae3ff21203afe8d0">   31</a></span>&#160;    minalloc             = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># minimum extra paragraphs needed</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a798f069cf6b43a7a65645d1ee3ab998b">   32</a></span>&#160;    maxalloc             = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># maximum extra paragraphs needed</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#ab3210368d26465bb0392b95250e74fc9">   33</a></span>&#160;    initial_ss           = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># initial (relative) SS value</span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a852118d78ac4df914bf7c0f2f6f7cea3">   34</a></span>&#160;    initial_sp           = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># initial sp value</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a08821aa65e212714b1574d009bfea88c">   35</a></span>&#160;    checksum             = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># checksum</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a034bf147e42c96a94633eedb74fc6927">   36</a></span>&#160;    initial_ip           = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># initial IP value</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a72abe047fa8aba05daefe75e998c3180">   37</a></span>&#160;    initial_cs           = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># initial (relative) CS value</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#ada5a425df185635c9e7ee3ac476f49c9">   38</a></span>&#160;    lfarlc               = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># file address of relocation table</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a4904dbe2224f9b8f1eb8ba61ad6621eb">   39</a></span>&#160;    ovno                 = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># overlay number</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a2e545e6e234a1ec86da92d2e97a1cae0">   40</a></span>&#160;    reserved0            = <span class="stringliteral">&quot;8s&quot;</span>   <span class="comment"># reserved block #0</span></div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a9bd0600d25de6ad65cb9dcbfbbc749ee">   41</a></span>&#160;    oemid                = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># OEM identifier (for oeminfo)</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#af658711612d2287b0e7f40be19257944">   42</a></span>&#160;    oeminfo              = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># OEM information; oemid-specific</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a57d6532eb488d64631a94de9ff247d88">   43</a></span>&#160;    reserved1            = <span class="stringliteral">&quot;20s&quot;</span>  <span class="comment"># reserved block #1</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#a05dd5f092dcbff4b3930ddc9ad7c74f8">   44</a></span>&#160;    coffheaderpos        = <span class="stringliteral">&quot;I&quot;</span>    <span class="comment"># address of new EXE header</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#af367af7de38e761600c8ebc4a54e2e97">   45</a></span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml#afea03a6337d57c7acdc7f378b8200a81">   46</a></span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">class </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml">PECOFFHeader</a>(<a class="code" href="classopenage_1_1util_1_1struct_1_1_named_struct.xhtml">NamedStruct</a>):</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">    The new (win32) PE and object file header.</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml">   52</a></span>&#160;    <span class="comment"># pylint: disable=bad-whitespace,too-few-public-methods</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    endianness = <span class="stringliteral">&quot;&lt;&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#aa6c447a01171c1cf805c66ecda4dc18a">   56</a></span>&#160;    signature            = <span class="stringliteral">&quot;4s&quot;</span>   <span class="comment"># always &#39;PE\0\0&#39;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    machine              = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># architecture; 332 means x86</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#a717fcd75b36cfc89f7049396c2c25fd4">   58</a></span>&#160;    number_of_sections   = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#ad6344f1e2189318b34b54159ce60d55e">   59</a></span>&#160;    time_stamp           = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#adad315c1b3f1c3d9b86b6f6534e971f0">   60</a></span>&#160;    symbol_table_ptr     = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#a61e9b9db617123f8f215d57a4f09db26">   61</a></span>&#160;    symbol_count         = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#add8fd03007bb88328b8ebd86a1ddd374">   62</a></span>&#160;    opt_header_size      = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#a0e57300c3ed231fba6c882e7c60dc49c">   63</a></span>&#160;    characteristics      = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># 2: exe; 512: non-relocatable; 8192: dll</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#a5d603ca265c111bdfc2704db28333097">   64</a></span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml#a6fa40348e1a86a7e4807f710aa3009d6">   65</a></span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">class </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml">PEOptionalHeader</a>(<a class="code" href="classopenage_1_1util_1_1struct_1_1_named_struct.xhtml">NamedStruct</a>):</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">    This &quot;optional&quot; header is required for linked files (but not object files).</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml">   71</a></span>&#160;    <span class="comment"># pylint: disable=bad-whitespace,too-few-public-methods</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    endianness = <span class="stringliteral">&quot;&lt;&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a62f8b111fadd180522de3e31d78e513c">   75</a></span>&#160;    signature            = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># 267: x86; 523: x86_64</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    major_linker_ver     = <span class="stringliteral">&quot;B&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#afdbab960d639ec2ea987d0f41edc02be">   77</a></span>&#160;    minor_linker_ver     = <span class="stringliteral">&quot;B&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#ab56d5053ecefec7a9be0847b670f8b64">   78</a></span>&#160;    size_of_code         = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a01b4c9d2710ee4c6df3db23bc68b1912">   79</a></span>&#160;    size_of_data         = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#abf6a4d8b250f99aabc09157a772e62b3">   80</a></span>&#160;    size_of_bss          = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#adef1eec5e7f5312a41fa6e655d6ec870">   81</a></span>&#160;    entry_point_addr     = <span class="stringliteral">&quot;I&quot;</span>    <span class="comment"># RVA of code entry point</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a29fa937d5daf1c306ce6e597693f9f1e">   82</a></span>&#160;    base_of_code         = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#af9ffd7159221bbcc1fdd56c78d2c5d30">   83</a></span>&#160;    base_of_data         = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a83004e653ec33c58d4549bd5ede08453">   84</a></span>&#160;    image_base           = <span class="stringliteral">&quot;I&quot;</span>    <span class="comment"># preferred memory location</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#ade85bbabd678a1ec8c9698fba29d1fcb">   85</a></span>&#160;    section_alignment    = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a12122b2e22da1c843653d8b7ecdf1673">   86</a></span>&#160;    file_alignment       = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a320d41214d35afcb94f41f664d4f6249">   87</a></span>&#160;    major_os_ver         = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a8adaa08c140c5825b3d6022358cb2b0d">   88</a></span>&#160;    minor_os_ver         = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#aaab3c4e93677a44b79ca9034194934bc">   89</a></span>&#160;    major_img_ver        = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#ae69b49843118e6fcd4cd7e80d4b2e57a">   90</a></span>&#160;    minor_img_ver        = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a858daaa464eb2e546919dbb1e279af28">   91</a></span>&#160;    major_subsys_ver     = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a235515ad381c7cb9c9ce955013c6dedc">   92</a></span>&#160;    minor_subsys_ver     = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a04107a8abfc2dc354c25120d4579d910">   93</a></span>&#160;    reserved             = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a39b76348f6e25049f6a4cf730a9a9d94">   94</a></span>&#160;    size_of_image        = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#afb3c8e12784e383992e426e582adbf62">   95</a></span>&#160;    size_of_headers      = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a8c06e4e6411e8fb79099af80abaaee1f">   96</a></span>&#160;    checksum             = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#aae96e7fcbade611c5a2b51b26b913e36">   97</a></span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a58826ea2a1c718428283305d9abe4299">   98</a></span>&#160;    <span class="comment"># the windows subsystem to run this executable.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment"># 1: native, 2: GUI, 3: non-GUI, 5: OS/2, 7: POSIX</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    subsystem            = <span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a34c865235e1ae3d1d7639655060f9bd0">  102</a></span>&#160;    dll_characteristics  = <span class="stringliteral">&quot;H&quot;</span>    <span class="comment"># some flags we&#39;re not interested in.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    stack_reserve_size   = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#aa61b602142a05fb5f4391cc1488c7ecd">  104</a></span>&#160;    stack_commit_size    = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#aed6c56605765801bd63f8ffe81a88993">  105</a></span>&#160;    heap_reserve_size    = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a0f3b76737433086565fe422a71a054c6">  106</a></span>&#160;    heap_commit_size     = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#ae9eb43a0276a3f212d622899fbcca879">  107</a></span>&#160;    loader_flags         = <span class="stringliteral">&quot;I&quot;</span>    <span class="comment"># we&#39;re not interested in those either.</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a0217d156b1906ea9d79bb2c947811d0b">  108</a></span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#ac305c3c3831f483895031d3dedf93912">  109</a></span>&#160;    <span class="comment"># describes the number of data directory headers that follow this header.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment"># always 16.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    data_directory_count = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#a9fb3fd337a5ce705160393abe715fb4d">  113</a></span>&#160;    <span class="comment"># written manually at some later point</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    data_directories     = <span class="keywordtype">None</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml#afdc4c444b59429911e398679dbebab98">  116</a></span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">class </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory.xhtml">PEDataDirectory</a>(<a class="code" href="classopenage_1_1util_1_1struct_1_1_named_struct.xhtml">NamedStruct</a>):</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">    Provides the locations of various metadata structures,</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">    which are used to set up the execution environment.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory.xhtml">  123</a></span>&#160;    <span class="comment"># pylint: disable=bad-whitespace,too-few-public-methods</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    endianness = <span class="stringliteral">&quot;&lt;&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory.xhtml#ae5b05f87af8ebdc7747206ea7a631b79">  127</a></span>&#160;    rva                = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    size               = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory.xhtml#a859edc9aadbe45734f69dacda2926e9c">  129</a></span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory.xhtml#ac57319a4a89a9d35b4007c37344193c7">  130</a></span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">class </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml">PESection</a>(<a class="code" href="classopenage_1_1util_1_1struct_1_1_named_struct.xhtml">NamedStruct</a>):</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">    Describes a section in a PE file (like an ELF section).</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml">  136</a></span>&#160;    <span class="comment"># pylint: disable=bad-whitespace,too-few-public-methods</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    endianness = <span class="stringliteral">&quot;&lt;&quot;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#ab626c46fca7d28efc1f34d603584af32">  140</a></span>&#160;    name               = <span class="stringliteral">&quot;8s&quot;</span>    <span class="comment"># first char must be &#39;.&#39;.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    virtual_size       = <span class="stringliteral">&quot;I&quot;</span>     <span class="comment"># size in memory</span></div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a446f95e13b6c249142b05c3ad6cf688d">  142</a></span>&#160;    virtual_address    = <span class="stringliteral">&quot;I&quot;</span>     <span class="comment"># RVA where the section will be loaded.</span></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a876b4ebc8d8460906735d64bd097fcb8">  143</a></span>&#160;    size_on_disk       = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a54849e82c5c2c8a20ea2b11f5a8d9eae">  144</a></span>&#160;    file_offset        = <span class="stringliteral">&quot;I&quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a03fc1590accfde0566086126b975b637">  145</a></span>&#160;    reserved           = <span class="stringliteral">&quot;12s&quot;</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a4544c9bb5a6efea48ff59beb79d2fcad">  146</a></span>&#160;    flags              = <span class="stringliteral">&quot;I&quot;</span>     <span class="comment"># some flags we don&#39;t care about</span></div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a61a9dfecbdf6282d89be9aa6037c90cb">  147</a></span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml#a647a5046ace5c1d877454ed7a3624430">  148</a></span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">class </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml">PEFile</a>:</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">    Reads Microsoft PE files.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="stringliteral">    The constructor takes a file-like object.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml">  156</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a60449ccfe2e14452ec0fcdde0b4bcfbc">__init__</a>(self, fileobj):</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment"># read DOS header</span></div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a60449ccfe2e14452ec0fcdde0b4bcfbc">  158</a></span>&#160;        doshdr = PEDOSHeader.read(fileobj)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> doshdr.signature != b<span class="stringliteral">&#39;MZ&#39;</span>:</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;not a PE file&quot;</span>)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment"># read COFF header</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        fileobj.seek(doshdr.coffheaderpos)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        coffhdr = PECOFFHeader.read(fileobj)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> coffhdr.signature != b<span class="stringliteral">&#39;PE\0\0&#39;</span>:</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;not a Win32 PE file&quot;</span>)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span> coffhdr.opt_header_size != 224:</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;unknown optional header size&quot;</span>)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment"># read optional header</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        opthdr = PEOptionalHeader.read(fileobj)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> opthdr.signature <span class="keywordflow">not</span> <span class="keywordflow">in</span> {267, 523}:</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Not an x86{_64} file&quot;</span>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment"># read data directories</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        opthdr.data_directories = []</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(opthdr.data_directory_count):</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            opthdr.data_directories.append(PEDataDirectory.read(fileobj))</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment"># read section headers</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        sections = {}</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(coffhdr.number_of_sections):</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            section = PESection.read(fileobj)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            section.name = section.name.decode(<span class="stringliteral">&#39;ascii&#39;</span>).<a class="code" href="namespaceopenage_1_1util.xhtml#abeb6a94572d93a14498661545b8332ec">rstrip</a>(<span class="stringliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> section.name.startswith(<span class="stringliteral">&#39;.&#39;</span>):</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Invalid section name: &quot;</span> + section.name)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            sections[section.name] = section</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment"># store all read header info</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#ae037be3836a1f3951820eee9cb28f256">fileobj</a> = fileobj</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#ae037be3836a1f3951820eee9cb28f256">  198</a></span>&#160;        self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a825d6d7c6a97dd4e8178bfa2e40ec56b">doshdr</a> = doshdr</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a427814db50bd73ba116cf8db256f878c">coffhdr</a> = coffhdr</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a825d6d7c6a97dd4e8178bfa2e40ec56b">  200</a></span>&#160;        self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a1b4bc09936e1d838803b5410a5655c99">opthdr</a> = opthdr</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a427814db50bd73ba116cf8db256f878c">  201</a></span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a1b4bc09936e1d838803b5410a5655c99">  202</a></span>&#160;        self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a93b0d4697c3c5c7fa41af57106e6b0ed">sections</a> = sections</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a93b0d4697c3c5c7fa41af57106e6b0ed">  204</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a22a79a0ca48b40b172ad7200649dffde">open_section</a>(self, section_name):</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="stringliteral">        Returns a tuple of data, va for the given section.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="stringliteral">        data is a file-like object (StreamFragment),</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="stringliteral">        and va is the RVA of the section start.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">if</span> section_name <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a93b0d4697c3c5c7fa41af57106e6b0ed">sections</a>:</div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a22a79a0ca48b40b172ad7200649dffde">  212</a></span>&#160;            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;no such section in PE file: &quot;</span> + section_name)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        section = self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a93b0d4697c3c5c7fa41af57106e6b0ed">sections</a>[section_name]</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classopenage_1_1util_1_1filelike_1_1stream_1_1_stream_fragment.xhtml">StreamFragment</a>(</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            self.<a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#ae037be3836a1f3951820eee9cb28f256">fileobj</a>,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            section.file_offset,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            section.virtual_size), section.virtual_address</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keyword">def </span><a class="code" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a60b529bb41cb0dec859e7443c430196f">resources</a>(self):</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">        Returns a PEResources object for self.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keyword">from</span> .peresource <span class="keyword">import</span> PEResources</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a60b529bb41cb0dec859e7443c430196f">  226</a></span>&#160;        <span class="keywordflow">return</span> PEResources(self)</div><div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml">openage.convert.pefile.PEFile</a></div><div class="ttdoc">Reads Microsoft PE files.</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00156">pefile.py:156</a></div></div>
<div class="ttc" id="classopenage_1_1util_1_1struct_1_1_named_struct_xhtml"><div class="ttname"><a href="classopenage_1_1util_1_1struct_1_1_named_struct.xhtml">openage::util.struct.NamedStruct</a></div><div class="ttdoc">Designed to be inherited from, similar to Enum.</div><div class="ttdef"><b>Definition:</b> <a href="struct_8py_source.xhtml#l00116">struct.py:116</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory_xhtml"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_data_directory.xhtml">openage.convert.pefile.PEDataDirectory</a></div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00123">pefile.py:123</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a22a79a0ca48b40b172ad7200649dffde"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a22a79a0ca48b40b172ad7200649dffde">openage.convert.pefile.PEFile.open_section</a></div><div class="ttdeci">def open_section(self, section_name)</div><div class="ttdoc">Returns a tuple of data, va for the given section.</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00212">pefile.py:212</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header_xhtml"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_d_o_s_header.xhtml">openage.convert.pefile.PEDOSHeader</a></div><div class="ttdoc">The (legacy) DOS-compatible PE header.</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00022">pefile.py:22</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header_xhtml"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_optional_header.xhtml">openage.convert.pefile.PEOptionalHeader</a></div><div class="ttdoc">This &quot;optional&quot; header is required for linked files (but not object files).</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00071">pefile.py:71</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_section_xhtml"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_section.xhtml">openage.convert.pefile.PESection</a></div><div class="ttdoc">Describes a section in a PE file (like an ELF section).</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00136">pefile.py:136</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_ae037be3836a1f3951820eee9cb28f256"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#ae037be3836a1f3951820eee9cb28f256">openage.convert.pefile.PEFile.fileobj</a></div><div class="ttdeci">fileobj</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00198">pefile.py:198</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a60b529bb41cb0dec859e7443c430196f"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a60b529bb41cb0dec859e7443c430196f">openage.convert.pefile.PEFile.resources</a></div><div class="ttdeci">def resources(self)</div><div class="ttdoc">Returns a PEResources object for self.</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00226">pefile.py:226</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a825d6d7c6a97dd4e8178bfa2e40ec56b"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a825d6d7c6a97dd4e8178bfa2e40ec56b">openage.convert.pefile.PEFile.doshdr</a></div><div class="ttdeci">doshdr</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00200">pefile.py:200</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a1b4bc09936e1d838803b5410a5655c99"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a1b4bc09936e1d838803b5410a5655c99">openage.convert.pefile.PEFile.opthdr</a></div><div class="ttdeci">opthdr</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00202">pefile.py:202</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a93b0d4697c3c5c7fa41af57106e6b0ed"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a93b0d4697c3c5c7fa41af57106e6b0ed">openage.convert.pefile.PEFile.sections</a></div><div class="ttdeci">sections</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00204">pefile.py:204</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a427814db50bd73ba116cf8db256f878c"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a427814db50bd73ba116cf8db256f878c">openage.convert.pefile.PEFile.coffhdr</a></div><div class="ttdeci">coffhdr</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00201">pefile.py:201</a></div></div>
<div class="ttc" id="classopenage_1_1util_1_1filelike_1_1stream_1_1_stream_fragment_xhtml"><div class="ttname"><a href="classopenage_1_1util_1_1filelike_1_1stream_1_1_stream_fragment.xhtml">openage::util::filelike.stream.StreamFragment</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8py_source.xhtml#l00118">stream.py:118</a></div></div>
<div class="ttc" id="namespaceopenage_1_1util_xhtml_abeb6a94572d93a14498661545b8332ec"><div class="ttname"><a href="namespaceopenage_1_1util.xhtml#abeb6a94572d93a14498661545b8332ec">openage::util::rstrip</a></div><div class="ttdeci">size_t rstrip(char *s)</div><div class="ttdef"><b>Definition:</b> <a href="strings_8cpp_source.xhtml#l00072">strings.cpp:72</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_file_xhtml_a60449ccfe2e14452ec0fcdde0b4bcfbc"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_file.xhtml#a60449ccfe2e14452ec0fcdde0b4bcfbc">openage.convert.pefile.PEFile.__init__</a></div><div class="ttdeci">def __init__(self, fileobj)</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00158">pefile.py:158</a></div></div>
<div class="ttc" id="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header_xhtml"><div class="ttname"><a href="classopenage_1_1convert_1_1pefile_1_1_p_e_c_o_f_f_header.xhtml">openage.convert.pefile.PECOFFHeader</a></div><div class="ttdoc">The new (win32) PE and object file header.</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8py_source.xhtml#l00052">pefile.py:52</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5432d0784b34fd012a3258f7fe2e6e8b.xhtml">openage</a></li><li class="navelem"><a class="el" href="dir_f8c2790f072062ca31393539e9a4c2e7.xhtml">convert</a></li><li class="navelem"><a class="el" href="pefile_8py.xhtml">pefile.py</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
