<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.15">
  <compounddef id="game__spec_8cpp" kind="file" language="C++">
    <compoundname>game_spec.cpp</compoundname>
    <includes refid="game__spec_8h" local="yes">game_spec.h</includes>
    <includes local="no">tuple</includes>
    <includes refid="assetmanager_8h" local="yes">../assetmanager.h</includes>
    <includes refid="audio_2error_8h" local="yes">../audio/error.h</includes>
    <includes refid="resource__def_8h" local="yes">../audio/resource_def.h</includes>
    <includes refid="engine_8h" local="yes">../engine.h</includes>
    <includes local="yes">../gamedata/blending_mode.gen.h</includes>
    <includes local="yes">../gamedata/string_resource.gen.h</includes>
    <includes local="yes">../gamedata/terrain.gen.h</includes>
    <includes refid="log_8h" local="yes">../log/log.h</includes>
    <includes refid="global__rng_8h" local="yes">../rng/global_rng.h</includes>
    <includes refid="producer_8h" local="yes">../unit/producer.h</includes>
    <includes refid="compiler_8h" local="yes">../util/compiler.h</includes>
    <includes refid="strings_8h" local="yes">../util/strings.h</includes>
    <includes refid="timer_8h" local="yes">../util/timer.h</includes>
    <includes refid="civilisation_8h" local="yes">civilisation.h</includes>
    <incdepgraph>
      <node id="9564">
        <label>list</label>
      </node>
      <node id="9539">
        <label>atomic</label>
      </node>
      <node id="9628">
        <label>coord/coordmanager.h</label>
        <link refid="coordmanager_8h"/>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
      </node>
      <node id="9590">
        <label>../util/fixed_point.h</label>
        <link refid="fixed__point_8h"/>
        <childnode refid="9591" relation="include">
        </childnode>
        <childnode refid="9592" relation="include">
        </childnode>
        <childnode refid="9593" relation="include">
        </childnode>
        <childnode refid="9560" relation="include">
        </childnode>
        <childnode refid="9594" relation="include">
        </childnode>
        <childnode refid="9595" relation="include">
        </childnode>
        <childnode refid="9556" relation="include">
        </childnode>
        <childnode refid="9596" relation="include">
        </childnode>
      </node>
      <node id="9560">
        <label>iomanip</label>
      </node>
      <node id="9540">
        <label>functional</label>
      </node>
      <node id="9637">
        <label>queue</label>
      </node>
      <node id="9594">
        <label>limits</label>
      </node>
      <node id="9589">
        <label>declarations.h</label>
        <link refid="declarations_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
        <childnode refid="9590" relation="include">
        </childnode>
      </node>
      <node id="9633">
        <label>guisys/public/gui_singleton_items_info.h</label>
        <link refid="gui__singleton__items__info_8h"/>
      </node>
      <node id="9665">
        <label>../gamedata/blending_mode.gen.h</label>
      </node>
      <node id="9534">
        <label>game_spec.h</label>
        <link refid="game__spec_8h"/>
        <childnode refid="9535" relation="include">
        </childnode>
        <childnode refid="9572" relation="include">
        </childnode>
        <childnode refid="9573" relation="include">
        </childnode>
        <childnode refid="9574" relation="include">
        </childnode>
        <childnode refid="9611" relation="include">
        </childnode>
        <childnode refid="9612" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9614" relation="include">
        </childnode>
      </node>
      <node id="9626">
        <label>hash_functions.h</label>
        <link refid="hash__functions_8h"/>
        <childnode refid="9615" relation="include">
        </childnode>
        <childnode refid="9618" relation="include">
        </childnode>
      </node>
      <node id="9605">
        <label>../texture.h</label>
        <link refid="texture_8h"/>
        <childnode refid="9606" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9607" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
        <childnode refid="9608" relation="include">
        </childnode>
        <childnode refid="9609" relation="include">
        </childnode>
        <childnode refid="9578" relation="include">
        </childnode>
      </node>
      <node id="9584">
        <label>setup.h</label>
        <link refid="setup_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
      </node>
      <node id="9614">
        <label>QObject</label>
      </node>
      <node id="9643">
        <label>input/input_manager.h</label>
        <link refid="input__manager_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9622" relation="include">
        </childnode>
        <childnode refid="9634" relation="include">
        </childnode>
        <childnode refid="9644" relation="include">
        </childnode>
        <childnode refid="9645" relation="include">
        </childnode>
        <childnode refid="9647" relation="include">
        </childnode>
      </node>
      <node id="9671">
        <label>civilisation.h</label>
        <link refid="civilisation_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9534" relation="include">
        </childnode>
      </node>
      <node id="9551">
        <label>cstdint</label>
      </node>
      <node id="9675">
        <label>../log/logsource.h</label>
        <link refid="logsource_8h"/>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9550" relation="include">
        </childnode>
      </node>
      <node id="9666">
        <label>../gamedata/string_resource.gen.h</label>
      </node>
      <node id="9599">
        <label>coord_nese.gen.h</label>
      </node>
      <node id="9630">
        <label>stdlib.h</label>
      </node>
      <node id="9663">
        <label>screenshot.h</label>
        <link refid="screenshot_8h"/>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9664" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
      </node>
      <node id="9558">
        <label>strings.h</label>
        <link refid="strings_8h"/>
        <childnode refid="9559" relation="include">
        </childnode>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9560" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9561" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
      </node>
      <node id="9569">
        <label>job_aborted_exception.h</label>
        <link refid="job__aborted__exception_8h"/>
        <childnode refid="9545" relation="include">
        </childnode>
      </node>
      <node id="9639">
        <label>abortable_job_state.h</label>
        <link refid="abortable__job__state_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9569" relation="include">
        </childnode>
        <childnode refid="9538" relation="include">
        </childnode>
        <childnode refid="9571" relation="include">
        </childnode>
      </node>
      <node id="9583">
        <label>exctranslate.h</label>
        <link refid="exctranslate_8h"/>
        <childnode refid="9543" relation="include">
        </childnode>
      </node>
      <node id="9618">
        <label>category.h</label>
        <link refid="category_8h"/>
        <childnode refid="9544" relation="include">
        </childnode>
      </node>
      <node id="9593">
        <label>cmath</label>
      </node>
      <node id="9572">
        <label>../gamedata/gamedata.gen.h</label>
      </node>
      <node id="9545">
        <label>stdexcept</label>
      </node>
      <node id="9582">
        <label>../util/language.h</label>
        <link refid="language_8h"/>
      </node>
      <node id="9654">
        <label>timing.h</label>
        <link refid="timing_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
      </node>
      <node id="9680">
        <label>attributes.h</label>
        <link refid="attributes_8h"/>
        <childnode refid="9678" relation="include">
        </childnode>
        <childnode refid="9677" relation="include">
        </childnode>
      </node>
      <node id="9577">
        <label>../assetmanager.h</label>
        <link refid="assetmanager_8h"/>
        <childnode refid="9552" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9578" relation="include">
        </childnode>
      </node>
      <node id="9659">
        <label>ability.h</label>
        <link refid="ability_8h"/>
        <childnode refid="9660" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9556" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9661" relation="include">
        </childnode>
      </node>
      <node id="9563">
        <label>logsink.h</label>
        <link refid="logsink_8h"/>
        <childnode refid="9564" relation="include">
        </childnode>
        <childnode refid="9565" relation="include">
        </childnode>
        <childnode refid="9566" relation="include">
        </childnode>
      </node>
      <node id="9559">
        <label>cstdarg</label>
      </node>
      <node id="9546">
        <label>string</label>
      </node>
      <node id="9550">
        <label>../log/message.h</label>
        <link refid="message_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9552" relation="include">
        </childnode>
        <childnode refid="9553" relation="include">
        </childnode>
        <childnode refid="9555" relation="include">
        </childnode>
        <childnode refid="9563" relation="include">
        </childnode>
        <childnode refid="9566" relation="include">
        </childnode>
      </node>
      <node id="9553">
        <label>../util/constexpr.h</label>
        <link refid="constexpr_8h"/>
        <childnode refid="9554" relation="include">
        </childnode>
      </node>
      <node id="9555">
        <label>../util/stringformatter.h</label>
        <link refid="stringformatter_8h"/>
        <childnode refid="9539" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9556" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
        <childnode refid="9557" relation="include">
        </childnode>
        <childnode refid="9558" relation="include">
        </childnode>
      </node>
      <node id="9678">
        <label>map</label>
      </node>
      <node id="9650">
        <label>util/variable.h</label>
        <link refid="variable_8h"/>
      </node>
      <node id="9533">
        <label>C:/Users/Jameson/Documents/git-projects/openage/libopenage/gamestate/game_spec.cpp</label>
        <link refid="game__spec_8cpp"/>
        <childnode refid="9534" relation="include">
        </childnode>
        <childnode refid="9615" relation="include">
        </childnode>
        <childnode refid="9577" relation="include">
        </childnode>
        <childnode refid="9616" relation="include">
        </childnode>
        <childnode refid="9617" relation="include">
        </childnode>
        <childnode refid="9621" relation="include">
        </childnode>
        <childnode refid="9665" relation="include">
        </childnode>
        <childnode refid="9666" relation="include">
        </childnode>
        <childnode refid="9667" relation="include">
        </childnode>
        <childnode refid="9623" relation="include">
        </childnode>
        <childnode refid="9668" relation="include">
        </childnode>
        <childnode refid="9669" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
        <childnode refid="9558" relation="include">
        </childnode>
        <childnode refid="9653" relation="include">
        </childnode>
        <childnode refid="9671" relation="include">
        </childnode>
      </node>
      <node id="9679">
        <label>../gamedata/unit.gen.h</label>
      </node>
      <node id="9646">
        <label>unordered_set</label>
      </node>
      <node id="9629">
        <label>cvar/cvar.h</label>
        <link refid="cvar_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9630" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9631" relation="include">
        </childnode>
        <childnode refid="9581" relation="include">
        </childnode>
        <childnode refid="9578" relation="include">
        </childnode>
      </node>
      <node id="9634">
        <label>handlers.h</label>
        <link refid="handlers_8h"/>
        <childnode refid="9622" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
      </node>
      <node id="9536">
        <label>exception</label>
      </node>
      <node id="9542">
        <label>stddef.h</label>
      </node>
      <node id="9667">
        <label>../gamedata/terrain.gen.h</label>
      </node>
      <node id="9613">
        <label>fstream</label>
      </node>
      <node id="9595">
        <label>ostream</label>
      </node>
      <node id="9632">
        <label>gui/engine_info.h</label>
        <link refid="engine__info_8h"/>
        <childnode refid="9578" relation="include">
        </childnode>
        <childnode refid="9633" relation="include">
        </childnode>
      </node>
      <node id="9676">
        <label>../terrain/terrain_object.h</label>
        <link refid="terrain__object_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9542" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
      </node>
      <node id="9635">
        <label>job/job_manager.h</label>
        <link refid="job__manager_8h"/>
        <childnode refid="9539" relation="include">
        </childnode>
        <childnode refid="9636" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9565" relation="include">
        </childnode>
        <childnode refid="9637" relation="include">
        </childnode>
        <childnode refid="9638" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9639" relation="include">
        </childnode>
        <childnode refid="9535" relation="include">
        </childnode>
        <childnode refid="9640" relation="include">
        </childnode>
        <childnode refid="9641" relation="include">
        </childnode>
        <childnode refid="9570" relation="include">
        </childnode>
        <childnode refid="9571" relation="include">
        </childnode>
      </node>
      <node id="9670">
        <label>../gamestate/player.h</label>
        <link refid="player_8h"/>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9671" relation="include">
        </childnode>
        <childnode refid="9672" relation="include">
        </childnode>
        <childnode refid="9661" relation="include">
        </childnode>
        <childnode refid="9673" relation="include">
        </childnode>
      </node>
      <node id="9579">
        <label>../pyinterface/pyobject.h</label>
        <link refid="pyobject_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9580" relation="include">
        </childnode>
        <childnode refid="9581" relation="include">
        </childnode>
      </node>
      <node id="9597">
        <label>limits.h</label>
      </node>
      <node id="9617">
        <label>../audio/resource_def.h</label>
        <link refid="resource__def_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9578" relation="include">
        </childnode>
        <childnode refid="9618" relation="include">
        </childnode>
        <childnode refid="9619" relation="include">
        </childnode>
        <childnode refid="9620" relation="include">
        </childnode>
      </node>
      <node id="9669">
        <label>../unit/producer.h</label>
        <link refid="producer_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
        <childnode refid="9572" relation="include">
        </childnode>
        <childnode refid="9573" relation="include">
        </childnode>
        <childnode refid="9670" relation="include">
        </childnode>
        <childnode refid="9674" relation="include">
        </childnode>
        <childnode refid="9682" relation="include">
        </childnode>
      </node>
      <node id="9543">
        <label>../error/error.h</label>
        <link refid="error_2error_8h"/>
        <childnode refid="9544" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9545" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
        <childnode refid="9550" relation="include">
        </childnode>
      </node>
      <node id="9596">
        <label>misc.h</label>
        <link refid="misc_8h"/>
        <childnode refid="9591" relation="include">
        </childnode>
        <childnode refid="9597" relation="include">
        </childnode>
        <childnode refid="9593" relation="include">
        </childnode>
        <childnode refid="9598" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9543" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
      </node>
      <node id="9612">
        <label>../util/csv.h</label>
        <link refid="csv_8h"/>
        <childnode refid="9554" relation="include">
        </childnode>
        <childnode refid="9598" relation="include">
        </childnode>
        <childnode refid="9613" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9543" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
        <childnode refid="9587" relation="include">
        </childnode>
        <childnode refid="9578" relation="include">
        </childnode>
      </node>
      <node id="9647">
        <label>input_context.h</label>
        <link refid="input__context_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9648" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9644" relation="include">
        </childnode>
        <childnode refid="9645" relation="include">
        </childnode>
      </node>
      <node id="9600">
        <label>coord_neseup.gen.h</label>
      </node>
      <node id="9642">
        <label>worker.h</label>
        <link refid="worker_8h"/>
        <childnode refid="9539" relation="include">
        </childnode>
        <childnode refid="9636" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9637" relation="include">
        </childnode>
        <childnode refid="9638" relation="include">
        </childnode>
        <childnode refid="9570" relation="include">
        </childnode>
      </node>
      <node id="9622">
        <label>SDL2/SDL.h</label>
      </node>
      <node id="9651">
        <label>util/externalprofiler.h</label>
        <link refid="externalprofiler_8h"/>
      </node>
      <node id="9636">
        <label>condition_variable</label>
      </node>
      <node id="9681">
        <label>command.h</label>
        <link refid="command_8h"/>
        <childnode refid="9646" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9659" relation="include">
        </childnode>
      </node>
      <node id="9568">
        <label>typeinfo</label>
      </node>
      <node id="9611">
        <label>../unit/unit_texture.h</label>
        <link refid="unit__texture_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9573" relation="include">
        </childnode>
      </node>
      <node id="9625">
        <label>audio/audio_manager.h</label>
        <link refid="audio__manager_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9622" relation="include">
        </childnode>
        <childnode refid="9618" relation="include">
        </childnode>
        <childnode refid="9626" relation="include">
        </childnode>
        <childnode refid="9627" relation="include">
        </childnode>
        <childnode refid="9617" relation="include">
        </childnode>
      </node>
      <node id="9627">
        <label>sound.h</label>
        <link refid="sound_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9618" relation="include">
        </childnode>
      </node>
      <node id="9660">
        <label>bitset</label>
      </node>
      <node id="9673">
        <label>score.h</label>
        <link refid="score_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9661" relation="include">
        </childnode>
      </node>
      <node id="9640">
        <label>job_group.h</label>
        <link refid="job__group_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9543" relation="include">
        </childnode>
        <childnode refid="9639" relation="include">
        </childnode>
        <childnode refid="9535" relation="include">
        </childnode>
        <childnode refid="9641" relation="include">
        </childnode>
        <childnode refid="9571" relation="include">
        </childnode>
        <childnode refid="9642" relation="include">
        </childnode>
      </node>
      <node id="9603">
        <label>coord_xy.gen.h</label>
      </node>
      <node id="9615">
        <label>tuple</label>
      </node>
      <node id="9664">
        <label>ctime</label>
      </node>
      <node id="9621">
        <label>../engine.h</label>
        <link refid="engine_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9622" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9614" relation="include">
        </childnode>
        <childnode refid="9623" relation="include">
        </childnode>
        <childnode refid="9624" relation="include">
        </childnode>
        <childnode refid="9625" relation="include">
        </childnode>
        <childnode refid="9628" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
        <childnode refid="9629" relation="include">
        </childnode>
        <childnode refid="9632" relation="include">
        </childnode>
        <childnode refid="9634" relation="include">
        </childnode>
        <childnode refid="9635" relation="include">
        </childnode>
        <childnode refid="9643" relation="include">
        </childnode>
        <childnode refid="9644" relation="include">
        </childnode>
        <childnode refid="9649" relation="include">
        </childnode>
        <childnode refid="9651" relation="include">
        </childnode>
        <childnode refid="9652" relation="include">
        </childnode>
        <childnode refid="9578" relation="include">
        </childnode>
        <childnode refid="9655" relation="include">
        </childnode>
        <childnode refid="9658" relation="include">
        </childnode>
        <childnode refid="9558" relation="include">
        </childnode>
        <childnode refid="9663" relation="include">
        </childnode>
      </node>
      <node id="9619">
        <label>format.h</label>
        <link refid="format_8h"/>
        <childnode refid="9595" relation="include">
        </childnode>
      </node>
      <node id="9662">
        <label>unit_container.h</label>
        <link refid="unit__container_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
        <childnode refid="9634" relation="include">
        </childnode>
        <childnode refid="9654" relation="include">
        </childnode>
      </node>
      <node id="9571">
        <label>types.h</label>
        <link refid="job_2types_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
      </node>
      <node id="9648">
        <label>stack</label>
      </node>
      <node id="9562">
        <label>vector</label>
      </node>
      <node id="9623">
        <label>log/log.h</label>
        <link refid="log_8h"/>
        <childnode refid="9566" relation="include">
        </childnode>
        <childnode refid="9550" relation="include">
        </childnode>
      </node>
      <node id="9548">
        <label>ciso646</label>
      </node>
      <node id="9644">
        <label>action.h</label>
        <link refid="input_2action_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
        <childnode refid="9645" relation="include">
        </childnode>
      </node>
      <node id="9538">
        <label>typed_job_state_base.h</label>
        <link refid="typed__job__state__base_8h"/>
        <childnode refid="9539" relation="include">
        </childnode>
        <childnode refid="9536" relation="include">
        </childnode>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9541" relation="include">
        </childnode>
        <childnode refid="9543" relation="include">
        </childnode>
        <childnode refid="9569" relation="include">
        </childnode>
        <childnode refid="9570" relation="include">
        </childnode>
        <childnode refid="9571" relation="include">
        </childnode>
      </node>
      <node id="9631">
        <label>utility</label>
      </node>
      <node id="9656">
        <label>array</label>
      </node>
      <node id="9608">
        <label>shader/program.h</label>
        <link refid="program_8h"/>
        <childnode refid="9606" relation="include">
        </childnode>
      </node>
      <node id="9561">
        <label>sstream</label>
      </node>
      <node id="9547">
        <label>../util/compiler.h</label>
        <link refid="compiler_8h"/>
        <childnode refid="9548" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9549" relation="include">
        </childnode>
      </node>
      <node id="9585">
        <label>file.h</label>
        <link refid="file_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9586" relation="include">
        </childnode>
        <childnode refid="9579" relation="include">
        </childnode>
      </node>
      <node id="9549">
        <label>signal.h</label>
        <link refid="signal_8h"/>
        <childnode refid="9549" relation="include">
        </childnode>
      </node>
      <node id="9661">
        <label>../gamestate/resource.h</label>
        <link refid="gamestate_2resource_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
      </node>
      <node id="9606">
        <label>epoxy/gl.h</label>
      </node>
      <node id="9557">
        <label>externalsstream.h</label>
        <link refid="externalsstream_8h"/>
        <childnode refid="9544" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
      </node>
      <node id="9566">
        <label>level.h</label>
        <link refid="level_8h"/>
        <childnode refid="9567" relation="include">
        </childnode>
      </node>
      <node id="9602">
        <label>../coord/pixel.h</label>
        <link refid="pixel_8h"/>
        <childnode refid="9603" relation="include">
        </childnode>
        <childnode refid="9589" relation="include">
        </childnode>
      </node>
      <node id="9587">
        <label>fslike/native.h</label>
        <link refid="fslike_2native_8h"/>
      </node>
      <node id="9607">
        <label>gamedata/texture.gen.h</label>
      </node>
      <node id="9586">
        <label>filelike/filelike.h</label>
        <link refid="filelike_8h"/>
        <childnode refid="9544" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
      </node>
      <node id="9554">
        <label>cstdlib</label>
      </node>
      <node id="9544">
        <label>iostream</label>
      </node>
      <node id="9649">
        <label>options.h</label>
        <link refid="options_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9650" relation="include">
        </childnode>
      </node>
      <node id="9658">
        <label>unit/selection.h</label>
        <link refid="selection_8h"/>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
        <childnode refid="9634" relation="include">
        </childnode>
        <childnode refid="9659" relation="include">
        </childnode>
        <childnode refid="9662" relation="include">
        </childnode>
      </node>
      <node id="9535">
        <label>../job/job.h</label>
        <link refid="job_8h"/>
        <childnode refid="9536" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9538" relation="include">
        </childnode>
      </node>
      <node id="9609">
        <label>shader/shader.h</label>
        <link refid="shader_2shader_8h"/>
        <childnode refid="9610" relation="include">
        </childnode>
        <childnode refid="9606" relation="include">
        </childnode>
      </node>
      <node id="9576">
        <label>unordered_map</label>
      </node>
      <node id="9641">
        <label>job_state.h</label>
        <link refid="job__state_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9538" relation="include">
        </childnode>
        <childnode refid="9571" relation="include">
        </childnode>
      </node>
      <node id="9674">
        <label>unit.h</label>
        <link refid="unit_8h"/>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9565" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9637" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9634" relation="include">
        </childnode>
        <childnode refid="9675" relation="include">
        </childnode>
        <childnode refid="9676" relation="include">
        </childnode>
        <childnode refid="9654" relation="include">
        </childnode>
        <childnode refid="9659" relation="include">
        </childnode>
        <childnode refid="9677" relation="include">
        </childnode>
        <childnode refid="9680" relation="include">
        </childnode>
        <childnode refid="9681" relation="include">
        </childnode>
        <childnode refid="9662" relation="include">
        </childnode>
      </node>
      <node id="9581">
        <label>functional.h</label>
        <link refid="functional_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9565" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
        <childnode refid="9582" relation="include">
        </childnode>
        <childnode refid="9583" relation="include">
        </childnode>
        <childnode refid="9584" relation="include">
        </childnode>
      </node>
      <node id="9592">
        <label>climits</label>
      </node>
      <node id="9668">
        <label>../rng/global_rng.h</label>
        <link refid="global__rng_8h"/>
      </node>
      <node id="9677">
        <label>attribute.h</label>
        <link refid="attribute_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9678" relation="include">
        </childnode>
        <childnode refid="9591" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
        <childnode refid="9679" relation="include">
        </childnode>
        <childnode refid="9676" relation="include">
        </childnode>
        <childnode refid="9661" relation="include">
        </childnode>
        <childnode refid="9662" relation="include">
        </childnode>
      </node>
      <node id="9565">
        <label>mutex</label>
      </node>
      <node id="9657">
        <label>chrono</label>
      </node>
      <node id="9588">
        <label>../coord/chunk.h</label>
        <link refid="chunk_8h"/>
        <childnode refid="9589" relation="include">
        </childnode>
        <childnode refid="9599" relation="include">
        </childnode>
        <childnode refid="9600" relation="include">
        </childnode>
      </node>
      <node id="9541">
        <label>../util/thread_id.h</label>
        <link refid="thread__id_8h"/>
        <childnode refid="9542" relation="include">
        </childnode>
      </node>
      <node id="9638">
        <label>thread</label>
      </node>
      <node id="9578">
        <label>util/path.h</label>
        <link refid="util_2path_8h"/>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9579" relation="include">
        </childnode>
        <childnode refid="9585" relation="include">
        </childnode>
        <childnode refid="9587" relation="include">
        </childnode>
      </node>
      <node id="9682">
        <label>unit_type.h</label>
        <link refid="unit__type_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9683" relation="include">
        </childnode>
        <childnode refid="9680" relation="include">
        </childnode>
      </node>
      <node id="9645">
        <label>event.h</label>
        <link refid="input_2event_8h"/>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9646" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
        <childnode refid="9622" relation="include">
        </childnode>
      </node>
      <node id="9604">
        <label>../coord/tile.h</label>
        <link refid="tile_8h"/>
        <childnode refid="9589" relation="include">
        </childnode>
        <childnode refid="9599" relation="include">
        </childnode>
        <childnode refid="9600" relation="include">
        </childnode>
        <childnode refid="9596" relation="include">
        </childnode>
      </node>
      <node id="9616">
        <label>../audio/error.h</label>
        <link refid="audio_2error_8h"/>
        <childnode refid="9543" relation="include">
        </childnode>
      </node>
      <node id="9580">
        <label>defs.h</label>
        <link refid="defs_8h"/>
      </node>
      <node id="9672">
        <label>population_tracker.h</label>
        <link refid="population__tracker_8h"/>
      </node>
      <node id="9655">
        <label>util/profiler.h</label>
        <link refid="profiler_8h"/>
        <childnode refid="9656" relation="include">
        </childnode>
        <childnode refid="9657" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9546" relation="include">
        </childnode>
      </node>
      <node id="9556">
        <label>type_traits</label>
      </node>
      <node id="9575">
        <label>set</label>
      </node>
      <node id="9552">
        <label>config.h</label>
      </node>
      <node id="9620">
        <label>loader_policy.h</label>
        <link refid="loader__policy_8h"/>
        <childnode refid="9595" relation="include">
        </childnode>
      </node>
      <node id="9591">
        <label>algorithm</label>
      </node>
      <node id="9570">
        <label>job_state_base.h</label>
        <link refid="job__state__base_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9571" relation="include">
        </childnode>
      </node>
      <node id="9601">
        <label>../coord/phys.h</label>
        <link refid="phys_8h"/>
        <childnode refid="9596" relation="include">
        </childnode>
        <childnode refid="9589" relation="include">
        </childnode>
        <childnode refid="9599" relation="include">
        </childnode>
        <childnode refid="9600" relation="include">
        </childnode>
      </node>
      <node id="9683">
        <label>../gamestate/cost.h</label>
        <link refid="cost_8h"/>
        <childnode refid="9661" relation="include">
        </childnode>
      </node>
      <node id="9598">
        <label>cstring</label>
      </node>
      <node id="9573">
        <label>../gamedata/graphic.gen.h</label>
      </node>
      <node id="9624">
        <label>log/file_logsink.h</label>
        <link refid="file__logsink_8h"/>
        <childnode refid="9544" relation="include">
        </childnode>
        <childnode refid="9613" relation="include">
        </childnode>
        <childnode refid="9563" relation="include">
        </childnode>
      </node>
      <node id="9574">
        <label>../terrain/terrain.h</label>
        <link refid="terrain_8h"/>
        <childnode refid="9540" relation="include">
        </childnode>
        <childnode refid="9537" relation="include">
        </childnode>
        <childnode refid="9542" relation="include">
        </childnode>
        <childnode refid="9575" relation="include">
        </childnode>
        <childnode refid="9576" relation="include">
        </childnode>
        <childnode refid="9562" relation="include">
        </childnode>
        <childnode refid="9577" relation="include">
        </childnode>
        <childnode refid="9588" relation="include">
        </childnode>
        <childnode refid="9601" relation="include">
        </childnode>
        <childnode refid="9602" relation="include">
        </childnode>
        <childnode refid="9604" relation="include">
        </childnode>
        <childnode refid="9605" relation="include">
        </childnode>
        <childnode refid="9596" relation="include">
        </childnode>
      </node>
      <node id="9653">
        <label>timer.h</label>
        <link refid="timer_8h"/>
        <childnode refid="9551" relation="include">
        </childnode>
        <childnode refid="9654" relation="include">
        </childnode>
      </node>
      <node id="9537">
        <label>memory</label>
      </node>
      <node id="9610">
        <label>initializer_list</label>
      </node>
      <node id="9652">
        <label>util/fps.h</label>
        <link refid="fps_8h"/>
        <childnode refid="9653" relation="include">
        </childnode>
      </node>
      <node id="9567">
        <label>../util/enum.h</label>
        <link refid="enum_8h"/>
        <childnode refid="9544" relation="include">
        </childnode>
        <childnode refid="9568" relation="include">
        </childnode>
        <childnode refid="9547" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innernamespace refid="namespaceopenage">openage</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>2015-2019<sp/>the<sp/>openage<sp/>authors.<sp/>See<sp/>copying.md<sp/>for<sp/>legal<sp/>info.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="game__spec_8h" kindref="compound">game_spec.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;tuple&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../assetmanager.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../audio/error.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../audio/resource_def.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../engine.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../gamedata/blending_mode.gen.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../gamedata/string_resource.gen.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../gamedata/terrain.gen.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../log/log.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../rng/global_rng.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../unit/producer.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../util/compiler.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../util/strings.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../util/timer.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="civilisation_8h" kindref="compound">civilisation.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceopenage" kindref="compound">openage</ref><sp/>{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25" refid="classopenage_1_1_game_spec_1a223fd0aa6ecdf3163f76f97ac766628e" refkind="member"><highlight class="normal"><ref refid="classopenage_1_1_game_spec_1a223fd0aa6ecdf3163f76f97ac766628e" kindref="member">GameSpec::GameSpec</ref>(<ref refid="classopenage_1_1_asset_manager" kindref="compound">AssetManager</ref><sp/>*am)</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>:</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/>assetmanager{am},</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/>gamedata_loaded{</highlight><highlight class="keyword">false</highlight><highlight class="normal">}<sp/>{</highlight></codeline>
<codeline lineno="29"><highlight class="normal">}</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31" refid="classopenage_1_1_game_spec_1a974dc4e7af42ddcc30b637f7e7861695" refkind="member"><highlight class="normal"><ref refid="classopenage_1_1_game_spec_1a974dc4e7af42ddcc30b637f7e7861695" kindref="member">GameSpec::~GameSpec</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="classopenage_1_1_game_spec_1a4de64c8c4a5463dc086f082659147b02" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a4de64c8c4a5463dc086f082659147b02" kindref="member">GameSpec::initialize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1util_1_1_timer" kindref="compound">util::Timer</ref><sp/>load_timer;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/>load_timer.<ref refid="classopenage_1_1util_1_1_timer_1afe1b5aca34f4b4151c6b85bafcd5dfd2" kindref="member">start</ref>();</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1util_1_1_path" kindref="compound">util::Path</ref><sp/>&amp;asset_dir<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1ab32bf393ec81c214585922c1a4cc9698" kindref="member">get_asset_dir</ref>();</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1a3f1815b698faf5786fc5e20bcac7704b" kindref="member">info</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Loading<sp/>game<sp/>specification<sp/>files...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;gamedata::string_resource&gt;<sp/>string_resources<sp/>=<sp/>util::read_csv_file&lt;gamedata::string_resource&gt;(</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>asset_dir[</highlight><highlight class="stringliteral">&quot;converted/string_resources.docx&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>read<sp/>the<sp/>packed<sp/>csv<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1util_1_1_c_s_v_collection" kindref="compound">util::CSVCollection</ref><sp/>raw_gamedata{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>asset_dir[</highlight><highlight class="stringliteral">&quot;converted/gamedata/gamedata.docx&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>parse<sp/>the<sp/>original<sp/>game<sp/>description<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref><sp/>=<sp/>raw_gamedata.read&lt;gamedata::empiresdat&gt;(</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;gamedata-empiresdat.docx&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6f6bbcfb3a4dd8586bbed00f62054bf1" kindref="member">load_terrain</ref>(this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0]);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>process<sp/>and<sp/>load<sp/>the<sp/>game<sp/>description<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a979c8104ad4832b1912e703f19558bc9" kindref="member">on_gamedata_loaded</ref>(this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0]);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a4cc5785668275bd468264822e2326acc" kindref="member">gamedata_loaded</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(<ref refid="classopenage_1_1error_1_1_error" kindref="compound">Error</ref><sp/>&amp;exc)<sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>rethrow<sp/>allmighty<sp/>openage<sp/>exceptions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(std::exception<sp/>&amp;exc)<sp/>{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>unfortunately<sp/>we<sp/>have<sp/>no<sp/>idea<sp/>of<sp/>the<sp/>std::exception<sp/>backtrace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1error_1_1_error" kindref="compound">Error</ref>{<ref refid="message_8h_1a735563036dced0b7d6cc98f97ea4978b" kindref="member">ERR</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;gamedata<sp/>could<sp/>not<sp/>be<sp/>loaded:<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/><ref refid="namespaceopenage_1_1util_1aebed129b2a0773520cdd8d40b0f70318" kindref="member">util::demangle</ref>(</highlight><highlight class="keyword">typeid</highlight><highlight class="normal">(exc).name())</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;:<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>exc.what()};</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1a3f1815b698faf5786fc5e20bcac7704b" kindref="member">info</ref>).fmt(</highlight><highlight class="stringliteral">&quot;Loading<sp/>time<sp/><sp/>[data]:<sp/>%5.3f<sp/>s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>load_timer.<ref refid="classopenage_1_1util_1_1_timer_1ad764a82c4de3f85c379ccc39c068f229" kindref="member">getval</ref>()<sp/>/<sp/>1e9));</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="77"><highlight class="normal">}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79" refid="classopenage_1_1_game_spec_1a19adf3ebe5c03a18675ef8dcd0a3c0d5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a19adf3ebe5c03a18675ef8dcd0a3c0d5" kindref="member">GameSpec::load_complete</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a4cc5785668275bd468264822e2326acc" kindref="member">gamedata_loaded</ref>;</highlight></codeline>
<codeline lineno="81"><highlight class="normal">}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83" refid="classopenage_1_1_game_spec_1a646cb1f106e9a5a853d8be6065836572" refkind="member"><highlight class="normal"><ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref><sp/>*<ref refid="classopenage_1_1_game_spec_1a646cb1f106e9a5a853d8be6065836572" kindref="member">GameSpec::get_terrain_meta</ref>()<sp/>{</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>&amp;this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal">}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="classopenage_1_1_game_spec_1ab7c5520835aa0ed3163340bb70e21f20" refkind="member"><highlight class="normal"><ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/><ref refid="classopenage_1_1_game_spec_1ab7c5520835aa0ed3163340bb70e21f20" kindref="member">GameSpec::get_slp_graphic</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>slp)<sp/>{</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7cefb930be58e9a11ab308c2c1fca351" kindref="member">slp_to_graphic</ref>[slp];</highlight></codeline>
<codeline lineno="89"><highlight class="normal">}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="classopenage_1_1_game_spec_1a949e9f7d9b1017a7f399c55a2bd60c9a" refkind="member"><highlight class="normal"><ref refid="classopenage_1_1_texture" kindref="compound">Texture</ref><sp/>*<ref refid="classopenage_1_1_game_spec_1a949e9f7d9b1017a7f399c55a2bd60c9a" kindref="member">GameSpec::get_texture</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>graphic_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(graphic_id<sp/>&lt;=<sp/>0<sp/>||<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>.count(graphic_id)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-&gt;<sp/>ignoring<sp/>graphics_id:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>graphic_id);</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>g<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>.at(graphic_id);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>slp_id<sp/>=<sp/>g-&gt;slp_id;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(slp_id<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-&gt;<sp/>ignoring<sp/>negative<sp/>slp_id:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>slp_id);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/>slp<sp/>id/name:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>slp_id<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>g-&gt;name);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>std::string<sp/>tex_fname<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1a5546877ed3bcad568ab21989a40ec088" kindref="member">util::sformat</ref>(</highlight><highlight class="stringliteral">&quot;converted/graphics/%d.slp.png&quot;</highlight><highlight class="normal">,<sp/>slp_id);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a949e9f7d9b1017a7f399c55a2bd60c9a" kindref="member">get_texture</ref>(tex_fname,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="108"><highlight class="normal">}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="classopenage_1_1_game_spec_1a0d9bb7cf5c16889a6eab13c714b39ae1" refkind="member"><highlight class="normal"><ref refid="classopenage_1_1_texture" kindref="compound">Texture</ref><sp/>*<ref refid="classopenage_1_1_game_spec_1a949e9f7d9b1017a7f399c55a2bd60c9a" kindref="member">GameSpec::get_texture</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string<sp/>&amp;file_name,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_metafile)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>nullptr<sp/>if<sp/>the<sp/>texture<sp/>wasn&apos;t<sp/>found<sp/>(3rd<sp/>param)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1a14ab6ac2616460d50bd789bf8bdd52eb" kindref="member">get_texture</ref>(file_name,<sp/>use_metafile,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="113"><highlight class="normal">}</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classopenage_1_1_game_spec_1a7ac1e52c333dbceea615911bd705fb88" refkind="member"><highlight class="normal">std::shared_ptr&lt;UnitTexture&gt;<sp/><ref refid="classopenage_1_1_game_spec_1a7ac1e52c333dbceea615911bd705fb88" kindref="member">GameSpec::get_unit_texture</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>unit_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1ad3367d0a1791303b8198e31fd5b4a22d" kindref="member">unit_textures</ref>.count(unit_id)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(unit_id<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-&gt;<sp/>ignoring<sp/>unit_id:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>unit_id);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ad3367d0a1791303b8198e31fd5b4a22d" kindref="member">unit_textures</ref>.at(unit_id);</highlight></codeline>
<codeline lineno="123"><highlight class="normal">}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="classopenage_1_1_game_spec_1a1b83c8dcc455fd32056c418a993eb506" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_sound" kindref="compound">Sound</ref><sp/>*<ref refid="classopenage_1_1_game_spec_1a1b83c8dcc455fd32056c418a993eb506" kindref="member">GameSpec::get_sound</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>sound_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1aafe40f5b33c85b4d7266b85814c5292a" kindref="member">available_sounds</ref>.count(sound_id)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sound_id<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-&gt;<sp/>ignoring<sp/>sound_id:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>sound_id);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>&amp;this-&gt;<ref refid="classopenage_1_1_game_spec_1aafe40f5b33c85b4d7266b85814c5292a" kindref="member">available_sounds</ref>.at(sound_id);</highlight></codeline>
<codeline lineno="133"><highlight class="normal">}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="classopenage_1_1_game_spec_1aa1f8784ca6aab9da489457d22b386443" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::graphic<sp/>*<ref refid="classopenage_1_1_game_spec_1aa1f8784ca6aab9da489457d22b386443" kindref="member">GameSpec::get_graphic_data</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>grp_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>.count(grp_id)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-&gt;<sp/>ignoring<sp/>grp_id:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>grp_id);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>.at(grp_id);</highlight></codeline>
<codeline lineno="142"><highlight class="normal">}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144" refid="classopenage_1_1_game_spec_1a37f6ca1f38ef68e4521d7536fb7d49e8" refkind="member"><highlight class="normal">std::vector&lt;const<sp/>gamedata::unit_command<sp/>*&gt;<sp/><ref refid="classopenage_1_1_game_spec_1a37f6ca1f38ef68e4521d7536fb7d49e8" kindref="member">GameSpec::get_command_data</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>unit_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a64c200779cfffebb00b3bdf830b781f5" kindref="member">commands</ref>.count(unit_id)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::vector&lt;const<sp/>gamedata::unit_command<sp/>*&gt;();<sp/></highlight><highlight class="comment">//<sp/>empty<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a64c200779cfffebb00b3bdf830b781f5" kindref="member">commands</ref>.at(unit_id);</highlight></codeline>
<codeline lineno="149"><highlight class="normal">}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151" refid="classopenage_1_1_game_spec_1a8589a31ec688308502a6d381a1a72235" refkind="member"><highlight class="normal">std::string<sp/><ref refid="classopenage_1_1_game_spec_1a8589a31ec688308502a6d381a1a72235" kindref="member">GameSpec::get_civ_name</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>civ_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0].civs.data[civ_id].name;</highlight></codeline>
<codeline lineno="153"><highlight class="normal">}</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155" refid="classopenage_1_1_game_spec_1ab009229f56624608b53820adf2895cbc" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1ab009229f56624608b53820adf2895cbc" kindref="member">GameSpec::create_unit_types</ref>(<ref refid="namespaceopenage_1a8a043d5389cb7a625dec595ea4b40636" kindref="member">unit_meta_list</ref><sp/>&amp;objects,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>civ_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!this-&gt;<ref refid="classopenage_1_1_game_spec_1a19adf3ebe5c03a18675ef8dcd0a3c0d5" kindref="member">load_complete</ref>())<sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>projectile<sp/>types<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;obj<sp/>:<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0].civs.data[civ_id].units.missile.data)<sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a67579e89ee667f00dc301433a23458af" kindref="member">load_missile</ref>(obj,<sp/>objects);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>object<sp/>unit<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;obj<sp/>:<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0].civs.data[civ_id].units.object.data)<sp/>{</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1af210d4508dea9f8f87aa98c3fc0e3359" kindref="member">load_object</ref>(obj,<sp/>objects);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>dead<sp/>unit<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;unit<sp/>:<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0].civs.data[civ_id].units.moving.data)<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1af210d4508dea9f8f87aa98c3fc0e3359" kindref="member">load_object</ref>(unit,<sp/>objects);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>living<sp/>unit<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;unit<sp/>:<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0].civs.data[civ_id].units.living.data)<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a51a1664688173a588e6ead16703f8e82" kindref="member">load_living</ref>(unit,<sp/>objects);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>building<sp/>unit<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a1b20e9021b3a16b059287caddc7862f6" kindref="member">building</ref><sp/>:<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>[0].civs.data[civ_id].units.building.data)<sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1acbe30bd72e3a9ef46c461e497d726711" kindref="member">load_building</ref>(<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a1b20e9021b3a16b059287caddc7862f6" kindref="member">building</ref>,<sp/>objects);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal">}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="classopenage_1_1_game_spec_1a3a21c92c49ec4d0add95e8aacd83ebe0" refkind="member"><highlight class="normal"><ref refid="classopenage_1_1_asset_manager" kindref="compound">AssetManager</ref><sp/>*<ref refid="classopenage_1_1_game_spec_1a3a21c92c49ec4d0add95e8aacd83ebe0" kindref="member">GameSpec::get_asset_manager</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>;</highlight></codeline>
<codeline lineno="189"><highlight class="normal">}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192" refid="classopenage_1_1_game_spec_1a979c8104ad4832b1912e703f19558bc9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a979c8104ad4832b1912e703f19558bc9" kindref="member">GameSpec::on_gamedata_loaded</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::empiresdat<sp/>&amp;gamedata)<sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1util_1_1_path" kindref="compound">util::Path</ref><sp/>&amp;asset_dir<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1ab32bf393ec81c214585922c1a4cc9698" kindref="member">get_asset_dir</ref>();</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1util_1_1_path" kindref="compound">util::Path</ref><sp/>sound_dir<sp/>=<sp/>asset_dir[</highlight><highlight class="stringliteral">&quot;converted/sounds&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>graphic<sp/>id<sp/>=&gt;<sp/>graphic<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;graphic<sp/>:<sp/><ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>.graphics.data)<sp/>{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>[graphic.id]<sp/>=<sp/>&amp;graphic;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7cefb930be58e9a11ab308c2c1fca351" kindref="member">slp_to_graphic</ref>[graphic.slp_id]<sp/>=<sp/>graphic.id;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1ae1103fea1e1b3c41ca3322d5389f7162" kindref="member">INFO</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Loading<sp/>textures...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>complete<sp/>set<sp/>of<sp/>unit<sp/>textures</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;g<sp/>:<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ad3367d0a1791303b8198e31fd5b4a22d" kindref="member">unit_textures</ref>.insert({g.first,<sp/>std::make_shared&lt;UnitTexture&gt;(*</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>g.second)});</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1ae1103fea1e1b3c41ca3322d5389f7162" kindref="member">INFO</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Loading<sp/>sounds...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>playable<sp/>sound<sp/>files<sp/>for<sp/>the<sp/>audio<sp/>manager</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;audio::resource_def&gt;<sp/>load_sound_files;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>all<sp/>sounds<sp/>defined<sp/>in<sp/>the<sp/>game<sp/>specification</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::sound<sp/>&amp;sound<sp/>:<sp/><ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>.sounds.data)<sp/>{</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::vector&lt;int&gt;<sp/>sound_items;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>each<sp/>sound<sp/>may<sp/>have<sp/>multiple<sp/>variation,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>processed<sp/>in<sp/>this<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>these<sp/>are<sp/>the<sp/>single<sp/>sound<sp/>files.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::sound_item<sp/>&amp;item<sp/>:<sp/>sound.sound_items.data)<sp/>{</highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(item.resource_id<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a2978637cb3650f636d3c199b1fc09592" kindref="member">SPAM</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/>Invalid<sp/>sound<sp/>resource<sp/>id<sp/>&lt;<sp/>0&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>snd_filename<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1a5546877ed3bcad568ab21989a40ec088" kindref="member">util::sformat</ref>(</highlight><highlight class="stringliteral">&quot;%d.opus&quot;</highlight><highlight class="normal">,<sp/>item.resource_id);</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1util_1_1_path" kindref="compound">util::Path</ref><sp/>snd_path<sp/>=<sp/>sound_dir[snd_filename];</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(not<sp/>snd_path.<ref refid="classopenage_1_1util_1_1_path_1aacfbbb9dd2e0ec286b5581690f9a83aa" kindref="member">is_file</ref>())<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>single<sp/>items<sp/>for<sp/>a<sp/>sound<sp/>(so<sp/>that<sp/>we<sp/>can<sp/>ramdomize<sp/>it)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sound_items.push_back(item.resource_id);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>single<sp/>sound<sp/>will<sp/>be<sp/>loaded<sp/>in<sp/>the<sp/>audio<sp/>system.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structopenage_1_1audio_1_1resource__def" kindref="compound">audio::resource_def</ref><sp/><ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a96ab4e163f4ee03aaa4d1051aa51d204" kindref="member">resource</ref><sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1audio_1ad0ada74763a06b76c42d3a351597e060a4504e1ed59cd9732b8a844e5424e6f13" kindref="member">audio::category_t::GAME</ref>,</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>item.resource_id,</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snd_path,</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1audio_1a6c4cc7d963b9dece05e3b8052a6cb6dba4c2223596711a6a941bc19e8067ceef9" kindref="member">audio::format_t::OPUS</ref>,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1audio_1a98fe517883b58083d26b038b34093299a0fcc90da4811c877ba9f9c12f7d60bc9" kindref="member">audio::loader_policy_t::DYNAMIC</ref></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>load_sound_files.push_back(<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a96ab4e163f4ee03aaa4d1051aa51d204" kindref="member">resource</ref>);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>test<sp/>sound<sp/>objects<sp/>that<sp/>can<sp/>be<sp/>played<sp/>later</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1aafe40f5b33c85b4d7266b85814c5292a" kindref="member">available_sounds</ref>.insert({</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sound.id,</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1_sound" kindref="compound">Sound</ref>{</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1a7278b1c0b8d94d06da155b0b693b2828a3734a903022249b3010be1897042568e" kindref="member">std::move</ref>(sound_items)</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>move<sp/>out<sp/>the<sp/>loading<sp/>of<sp/>the<sp/>sound.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>class<sp/>only<sp/>provides<sp/>the<sp/>names<sp/>and<sp/>locations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>load<sp/>the<sp/>requested<sp/>sounds.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1audio_1_1_audio_manager" kindref="compound">audio::AudioManager</ref><sp/>&amp;am<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1a50069b4b3cd4b5fcf8fb5f4b480c721d" kindref="member">get_engine</ref>()-&gt;<ref refid="classopenage_1_1_engine_1ad925a7a6258d1382edd274ee4ceafdbd" kindref="member">get_audio_manager</ref>();</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>am.<ref refid="classopenage_1_1audio_1_1_audio_manager_1a7d1dc28dded852d3eadf34771ee8f6b0" kindref="member">load_resources</ref>(load_sound_files);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>final<sp/>step<sp/>occurs<sp/>after<sp/>loading<sp/>media</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>as<sp/>producers<sp/>require<sp/>both<sp/>the<sp/>graphics<sp/>and<sp/>sounds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ad72bef762bb38fb93c944d490bf5c113" kindref="member">create_abilities</ref>(gamedata);</highlight></codeline>
<codeline lineno="270"><highlight class="normal">}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272" refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" kindref="member">GameSpec::valid_graphic_id</ref>(<ref refid="namespaceopenage_1a8f00ffffd7d8386f3c406ec373e100bf" kindref="member">index_t</ref><sp/>graphic_id)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(graphic_id<sp/>&lt;=<sp/>0<sp/>||<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>.count(graphic_id)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a6e01d394f1d6b8c85ee0922f4cee072b" kindref="member">graphics</ref>.at(graphic_id)-&gt;slp_id<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="280"><highlight class="normal">}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282" refid="classopenage_1_1_game_spec_1acbe30bd72e3a9ef46c461e497d726711" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1acbe30bd72e3a9ef46c461e497d726711" kindref="member">GameSpec::load_building</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::building_unit<sp/>&amp;building,<sp/><ref refid="namespaceopenage_1a8a043d5389cb7a625dec595ea4b40636" kindref="member">unit_meta_list</ref><sp/>&amp;<ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>graphics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" kindref="member">valid_graphic_id</ref>(building.graphic_standing0))<sp/>{</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>meta_type<sp/>=<sp/>std::make_shared&lt;UnitTypeMeta&gt;(</highlight><highlight class="stringliteral">&quot;Building&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a1b20e9021b3a16b059287caddc7862f6" kindref="member">building</ref>.id0,<sp/>[</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a1b20e9021b3a16b059287caddc7862f6" kindref="member">building</ref>](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_player" kindref="compound">Player</ref><sp/>&amp;<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a72122ce96bfec66e2396d2e25225d70a" kindref="member">owner</ref>)<sp/>{</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>std::make_shared&lt;BuildingProducer&gt;(owner,<sp/>*this,<sp/>&amp;building);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>.emplace_back(meta_type);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal">}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293" refid="classopenage_1_1_game_spec_1a51a1664688173a588e6ead16703f8e82" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a51a1664688173a588e6ead16703f8e82" kindref="member">GameSpec::load_living</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::living_unit<sp/>&amp;unit,<sp/><ref refid="namespaceopenage_1a8a043d5389cb7a625dec595ea4b40636" kindref="member">unit_meta_list</ref><sp/>&amp;<ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>graphics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" kindref="member">valid_graphic_id</ref>(unit.dying_graphic)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;valid_graphic_id(unit.graphic_standing0)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" kindref="member">valid_graphic_id</ref>(unit.walking_graphics0))<sp/>{</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>meta_type<sp/>=<sp/>std::make_shared&lt;UnitTypeMeta&gt;(</highlight><highlight class="stringliteral">&quot;Living&quot;</highlight><highlight class="normal">,<sp/>unit.id0,<sp/>[</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;unit](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_player" kindref="compound">Player</ref><sp/>&amp;<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a72122ce96bfec66e2396d2e25225d70a" kindref="member">owner</ref>)<sp/>{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>std::make_shared&lt;LivingProducer&gt;(owner,<sp/>*this,<sp/>&amp;unit);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>.emplace_back(meta_type);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="304"><highlight class="normal">}</highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306" refid="classopenage_1_1_game_spec_1af210d4508dea9f8f87aa98c3fc0e3359" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1af210d4508dea9f8f87aa98c3fc0e3359" kindref="member">GameSpec::load_object</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::unit_object<sp/>&amp;</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">,<sp/><ref refid="namespaceopenage_1a8a043d5389cb7a625dec595ea4b40636" kindref="member">unit_meta_list</ref><sp/>&amp;<ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>graphics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" kindref="member">valid_graphic_id</ref>(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">.graphic_standing0))<sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>meta_type<sp/>=<sp/>std::make_shared&lt;UnitTypeMeta&gt;(</highlight><highlight class="stringliteral">&quot;Object&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">object</highlight><highlight class="normal">.id0,<sp/>[</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_player" kindref="compound">Player</ref><sp/>&amp;<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a72122ce96bfec66e2396d2e25225d70a" kindref="member">owner</ref>)<sp/>{</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::make_shared&lt;ObjectProducer&gt;(<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a72122ce96bfec66e2396d2e25225d70a" kindref="member">owner</ref>,<sp/>*</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>.emplace_back(meta_type);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="315"><highlight class="normal">}</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317" refid="classopenage_1_1_game_spec_1a67579e89ee667f00dc301433a23458af" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a67579e89ee667f00dc301433a23458af" kindref="member">GameSpec::load_missile</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::missile_unit<sp/>&amp;proj,<sp/><ref refid="namespaceopenage_1a8a043d5389cb7a625dec595ea4b40636" kindref="member">unit_meta_list</ref><sp/>&amp;<ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>graphics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_1a4183e5b82dd51fd66629d287026b5daa" kindref="member">valid_graphic_id</ref>(proj.graphic_standing0))<sp/>{</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>meta_type<sp/>=<sp/>std::make_shared&lt;UnitTypeMeta&gt;(</highlight><highlight class="stringliteral">&quot;Projectile&quot;</highlight><highlight class="normal">,<sp/>proj.id0,<sp/>[</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;proj](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_player" kindref="compound">Player</ref><sp/>&amp;<ref refid="namespaceopenage_1a38adadf644885a7fe121be11ffeb8c36a72122ce96bfec66e2396d2e25225d70a" kindref="member">owner</ref>)<sp/>{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>std::make_shared&lt;ProjectileProducer&gt;(owner,<sp/>*this,<sp/>&amp;proj);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>.emplace_back(meta_type);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="326"><highlight class="normal">}</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329" refid="classopenage_1_1_game_spec_1a6f6bbcfb3a4dd8586bbed00f62054bf1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1a6f6bbcfb3a4dd8586bbed00f62054bf1" kindref="member">GameSpec::load_terrain</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::empiresdat<sp/>&amp;gamedata)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fetch<sp/>blending<sp/>modes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1util_1_1_path" kindref="compound">util::Path</ref><sp/>convert_dir<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1ab32bf393ec81c214585922c1a4cc9698" kindref="member">get_asset_dir</ref>()[</highlight><highlight class="stringliteral">&quot;converted&quot;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;gamedata::blending_mode&gt;<sp/>blending_meta<sp/>=<sp/>util::read_csv_file&lt;gamedata::blending_mode&gt;(</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>convert_dir[</highlight><highlight class="stringliteral">&quot;blending_modes.docx&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>copy<sp/>the<sp/>terrain<sp/>metainformation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;gamedata::terrain_type&gt;<sp/><ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref><sp/>=<sp/><ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>.terrains.data;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>remove<sp/>any<sp/>disabled<sp/>textures</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref>.erase(</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::remove_if(</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref>.begin(),</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref>.end(),</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[]<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::terrain_type<sp/>&amp;t)<sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>not<sp/>t.enabled;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref>.end()</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>result<sp/>attributes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>terrain_meta.size();</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1ac0a032b35502a554d168d791213ad74c" kindref="member">blendmode_count</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>blending_meta.size();</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a4b4c97d4834037b1ff79270d5c4876f7" kindref="member">textures</ref>.resize(<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref>);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a2fdf2bb79faa0aa896e6f8cec3ffad72" kindref="member">blending_masks</ref>.reserve(<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1ac0a032b35502a554d168d791213ad74c" kindref="member">blendmode_count</ref>);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a42422b3e85c83467828991b119ca216c" kindref="member">terrain_id_priority_map</ref><sp/><sp/>=<sp/>std::make_unique&lt;int[]&gt;(</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1ad4721fb504831e4c6797380603f3c734" kindref="member">terrain_id_blendmode_map</ref><sp/>=<sp/>std::make_unique&lt;int[]&gt;(</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a80c4c8312262c03a979437c70a3eb4eb" kindref="member">influences_buf</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>std::make_unique&lt;struct<sp/>influence[]&gt;(</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Terrain<sp/>prefs:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;tiletypes=&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;blendmodes=&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1ac0a032b35502a554d168d791213ad74c" kindref="member">blendmode_count</ref>);</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>tile<sp/>textures<sp/>(snow,<sp/>ice,<sp/>grass,<sp/>whatever)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>terrain_id<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>terrain_id<sp/>&lt;<sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1adac0256f3bb43b543864aba0079d84a8" kindref="member">terrain_id_count</ref>;</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>terrain_id++)<sp/>{</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="namespaceopenage_1a0093da9e88fad4b564ffa3c2fed20f20a6438c669e0d0de98e6929c2cc0fac474" kindref="member">line</ref><sp/>=<sp/>&amp;<ref refid="structopenage_1_1terrain__meta" kindref="compound">terrain_meta</ref>[terrain_id];</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>terrain<sp/>double-define<sp/>check?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a42422b3e85c83467828991b119ca216c" kindref="member">terrain_id_priority_map</ref>[terrain_id]<sp/><sp/>=<sp/><ref refid="namespaceopenage_1a0093da9e88fad4b564ffa3c2fed20f20a6438c669e0d0de98e6929c2cc0fac474" kindref="member">line</ref>-&gt;blend_priority;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1ad4721fb504831e4c6797380603f3c734" kindref="member">terrain_id_blendmode_map</ref>[terrain_id]<sp/>=<sp/><ref refid="namespaceopenage_1a0093da9e88fad4b564ffa3c2fed20f20a6438c669e0d0de98e6929c2cc0fac474" kindref="member">line</ref>-&gt;blend_mode;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>remove<sp/>hardcoding<sp/>and<sp/>rely<sp/>on<sp/>nyan<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>terraintex_filename<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1a5546877ed3bcad568ab21989a40ec088" kindref="member">util::sformat</ref>(</highlight><highlight class="stringliteral">&quot;converted/terrain/%d.slp.png&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1a0093da9e88fad4b564ffa3c2fed20f20a6438c669e0d0de98e6929c2cc0fac474" kindref="member">line</ref>-&gt;slp_id);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>new_texture<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1a14ab6ac2616460d50bd789bf8bdd52eb" kindref="member">get_texture</ref>(terraintex_filename,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a4b4c97d4834037b1ff79270d5c4876f7" kindref="member">textures</ref>[terrain_id]<sp/>=<sp/>new_texture;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>blending<sp/>masks<sp/>(see<sp/>doc/media/blendomatic)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1ac0a032b35502a554d168d791213ad74c" kindref="member">blendmode_count</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="namespaceopenage_1a0093da9e88fad4b564ffa3c2fed20f20a6438c669e0d0de98e6929c2cc0fac474" kindref="member">line</ref><sp/>=<sp/>&amp;blending_meta[i];</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>remove<sp/>hardcodingn<sp/>and<sp/>use<sp/>nyan<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>mask_filename<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1a5546877ed3bcad568ab21989a40ec088" kindref="member">util::sformat</ref>(</highlight><highlight class="stringliteral">&quot;converted/blendomatic/mode%02d.png&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1a0093da9e88fad4b564ffa3c2fed20f20a6438c669e0d0de98e6929c2cc0fac474" kindref="member">line</ref>-&gt;blend_mode);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1_game_spec_1a7fc2fe6626e99e9bab20b66287e5f58a" kindref="member">terrain_data</ref>.<ref refid="structopenage_1_1terrain__meta_1a2fdf2bb79faa0aa896e6f8cec3ffad72" kindref="member">blending_masks</ref>[i]<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1ae2b8a6bdf7a14d4dfa22a963edf0d24b" kindref="member">assetmanager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1a14ab6ac2616460d50bd789bf8bdd52eb" kindref="member">get_texture</ref>(mask_filename);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal">}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404" refid="classopenage_1_1_game_spec_1ad72bef762bb38fb93c944d490bf5c113" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_1ad72bef762bb38fb93c944d490bf5c113" kindref="member">GameSpec::create_abilities</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gamedata::empiresdat<sp/>&amp;gamedata)<sp/>{</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>game<sp/>data<sp/>unit<sp/>commands</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>headers<sp/>=<sp/><sp/><ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>.unit_headers.data.size();</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>total<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>it<sp/>seems<sp/>the<sp/>index<sp/>of<sp/>the<sp/>header<sp/>indicates<sp/>the<sp/>unit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>headers;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>init<sp/>unit<sp/>command<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::vector&lt;const<sp/>gamedata::unit_command<sp/>*&gt;<sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>each<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;head<sp/>=<sp/><ref refid="classopenage_1_1_game_spec_1ae74164c6aad1ea4d1ed4c4368b91711a" kindref="member">gamedata</ref>.unit_headers.data[i];</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;cmd<sp/>:<sp/>head.unit_commands.data)<sp/>{</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>total++;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>commands<sp/>either<sp/>have<sp/>a<sp/>class<sp/>id<sp/>or<sp/>a<sp/>unit<sp/>id</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>log::dbg(&quot;unit<sp/>command<sp/>%d<sp/>%d<sp/>-&gt;<sp/>class<sp/>%d,<sp/>unit<sp/>%d,<sp/>resource<sp/>%d&quot;,<sp/>i,<sp/>cmd.id,<sp/>cmd.class_id,<sp/>cmd.unit_id,<sp/>cmd.resource_in);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>.push_back(&amp;cmd);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>insert<sp/>to<sp/>command<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_1a64c200779cfffebb00b3bdf830b781f5" kindref="member">commands</ref>[i]<sp/>=<sp/><ref refid="namespaceopenage_1_1py_1a58cbca251b8e2118e0a6b9b0b78a7b32" kindref="member">list</ref>;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="428"><highlight class="normal">}</highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"></highlight></codeline>
<codeline lineno="431" refid="classopenage_1_1_sound_1a526acd600cd69f6f421a253fc169398b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_sound_1a526acd600cd69f6f421a253fc169398b" kindref="member">Sound::play</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_sound_1a13e53bc9f4210f9fc020661994a72f47" kindref="member">sound_items</ref>.size()<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rand<sp/>=<sp/><ref refid="namespaceopenage_1_1rng_1a398e36f7942536cd461ca212dfee6cb5" kindref="member">rng::random_range</ref>(0,<sp/>this-&gt;<ref refid="classopenage_1_1_sound_1a13e53bc9f4210f9fc020661994a72f47" kindref="member">sound_items</ref>.size());</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sndid<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_sound_1a13e53bc9f4210f9fc020661994a72f47" kindref="member">sound_items</ref>.at(rand);</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>buhuuuu<sp/>gnargghh<sp/>this<sp/>has<sp/>to<sp/>be<sp/>moved<sp/>to<sp/>the<sp/>asset<sp/>loading<sp/>subsystem<sp/>hnnnng</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1audio_1_1_audio_manager" kindref="compound">audio::AudioManager</ref><sp/>&amp;am<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_sound_1ab5fb74b970363e956f0aaa2386d8c568" kindref="member">game_spec</ref>-&gt;<ref refid="classopenage_1_1_game_spec_1a3a21c92c49ec4d0add95e8aacd83ebe0" kindref="member">get_asset_manager</ref>()-&gt;<ref refid="classopenage_1_1_asset_manager_1a50069b4b3cd4b5fcf8fb5f4b480c721d" kindref="member">get_engine</ref>()-&gt;<ref refid="classopenage_1_1_engine_1ad925a7a6258d1382edd274ee4ceafdbd" kindref="member">get_audio_manager</ref>();</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(not<sp/>am.<ref refid="classopenage_1_1audio_1_1_audio_manager_1a6df7195e7f02f6959a9a241037e48657" kindref="member">is_available</ref>())<sp/>{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1audio_1_1_sound" kindref="compound">audio::Sound</ref><sp/>sound<sp/>=<sp/>am.<ref refid="classopenage_1_1audio_1_1_audio_manager_1a4fcd0ea2e63f5035df72bdceb0ac22f2" kindref="member">get_sound</ref>(<ref refid="namespaceopenage_1_1audio_1ad0ada74763a06b76c42d3a351597e060a4504e1ed59cd9732b8a844e5424e6f13" kindref="member">audio::category_t::GAME</ref>,<sp/>sndid);</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sound.<ref refid="classopenage_1_1audio_1_1_sound_1a7e4854e55386f2498a332eed36e374d4" kindref="member">play</ref>();</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(<ref refid="classopenage_1_1audio_1_1_error" kindref="compound">audio::Error</ref><sp/>&amp;e)<sp/>{</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1a0eff614e7d6e818746700ed9d29e583f" kindref="member">log::log</ref>(<ref refid="message_8h_1a8adfad4f54eb306fbb8aaa1b159608a5" kindref="member">MSG</ref>(<ref refid="namespaceopenage_1_1log_1a7ca418e1b1fcf210ff91cd25dc8e6a36" kindref="member">warn</ref>)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;cannot<sp/>play:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>e);</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="453"><highlight class="normal">}</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455" refid="classopenage_1_1_game_spec_handle_1a23718c700764a8ffe7e3e82218b56dc8" refkind="member"><highlight class="normal"><ref refid="classopenage_1_1_game_spec_handle_1a23718c700764a8ffe7e3e82218b56dc8" kindref="member">GameSpecHandle::GameSpecHandle</ref>(<ref refid="classqtsdl_1_1_gui_item_link" kindref="compound">qtsdl::GuiItemLink</ref><sp/>*gui_link)</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>:</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>active{},</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>asset_manager{},</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/>gui_signals{std::make_shared&lt;GameSpecSignals&gt;()},</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>gui_link{gui_link}<sp/>{</highlight></codeline>
<codeline lineno="461"><highlight class="normal">}</highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight></codeline>
<codeline lineno="463" refid="classopenage_1_1_game_spec_handle_1ab7fe02e9268aff99041da5e2684d2e4d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1ab7fe02e9268aff99041da5e2684d2e4d" kindref="member">GameSpecHandle::set_active</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>active)<sp/>{</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;active<sp/>=<sp/><ref refid="classopenage_1_1_game_spec_handle_1a54699d8be271264a4feb3ddffe169865" kindref="member">active</ref>;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1ab95bd8daf4250f175a5ebb3c6753277d" kindref="member">start_loading_if_needed</ref>();</highlight></codeline>
<codeline lineno="467"><highlight class="normal">}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469" refid="classopenage_1_1_game_spec_handle_1ad9c03812749a8ac9b21960e0f5bb462e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1ad9c03812749a8ac9b21960e0f5bb462e" kindref="member">GameSpecHandle::set_asset_manager</ref>(<ref refid="classopenage_1_1_asset_manager" kindref="compound">AssetManager</ref><sp/>*asset_manager)<sp/>{</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;asset_manager<sp/>!=<sp/><ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref>)<sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;asset_manager<sp/>=<sp/><ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref>;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1ab95bd8daf4250f175a5ebb3c6753277d" kindref="member">start_loading_if_needed</ref>();</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="475"><highlight class="normal">}</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="477" refid="classopenage_1_1_game_spec_handle_1a66912843935edcdb600cd47bc58e6cb0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1a66912843935edcdb600cd47bc58e6cb0" kindref="member">GameSpecHandle::is_ready</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref><sp/>&amp;&amp;<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref>-&gt;load_complete();</highlight></codeline>
<codeline lineno="479"><highlight class="normal">}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"></highlight></codeline>
<codeline lineno="481" refid="classopenage_1_1_game_spec_handle_1a019a81d88722206e82c7b5c87ddfe04f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1a019a81d88722206e82c7b5c87ddfe04f" kindref="member">GameSpecHandle::invalidate</ref>()<sp/>{</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref>)</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1add18a1e0933affe40c982f62c88f4c05" kindref="member">check_updates</ref>();</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1ab95bd8daf4250f175a5ebb3c6753277d" kindref="member">start_loading_if_needed</ref>();</highlight></codeline>
<codeline lineno="488"><highlight class="normal">}</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490" refid="classopenage_1_1_game_spec_handle_1a4598e32e6a01733806234d193a871255" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1a4598e32e6a01733806234d193a871255" kindref="member">GameSpecHandle::announce_spec</ref>()<sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref><sp/>&amp;&amp;<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref>-&gt;load_complete())</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emit<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a05d8b8251196b389e267b646e6356526" kindref="member">gui_signals</ref>-&gt;game_spec_loaded(this-&gt;spec);</highlight></codeline>
<codeline lineno="493"><highlight class="normal">}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495" refid="classopenage_1_1_game_spec_handle_1aaf18425a59c8ec0b7e7fa176c64b8bc8" refkind="member"><highlight class="normal">std::shared_ptr&lt;GameSpec&gt;<sp/><ref refid="classopenage_1_1_game_spec_handle_1aaf18425a59c8ec0b7e7fa176c64b8bc8" kindref="member">GameSpecHandle::get_spec</ref>()<sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref>;</highlight></codeline>
<codeline lineno="497"><highlight class="normal">}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="499" refid="classopenage_1_1_game_spec_handle_1ab95bd8daf4250f175a5ebb3c6753277d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1ab95bd8daf4250f175a5ebb3c6753277d" kindref="member">GameSpecHandle::start_loading_if_needed</ref>()<sp/>{</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a54699d8be271264a4feb3ddffe169865" kindref="member">active</ref><sp/>&amp;&amp;<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref><sp/>&amp;&amp;<sp/>!this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref>)<sp/>{</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>the<sp/>game<sp/>specification</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref><sp/>=<sp/>std::make_shared&lt;GameSpec&gt;(this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref>);</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>load<sp/>the<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1afcf8867f4e0077e6a8a2a6fe6c0c98ff" kindref="member">start_load_job</ref>();</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="508"><highlight class="normal">}</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510" refid="classopenage_1_1_game_spec_handle_1afcf8867f4e0077e6a8a2a6fe6c0c98ff" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1_game_spec_handle_1afcf8867f4e0077e6a8a2a6fe6c0c98ff" kindref="member">GameSpecHandle::start_load_job</ref>()<sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>store<sp/>the<sp/>shared<sp/>pointers<sp/>in<sp/>another<sp/>sharedptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>so<sp/>we<sp/>can<sp/>pass<sp/>them<sp/>to<sp/>the<sp/>other<sp/>thread</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>spec_and_job<sp/>=<sp/>std::make_tuple(this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a9794524a651ba717256e50a0fa4e0a37" kindref="member">spec</ref>,<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a05d8b8251196b389e267b646e6356526" kindref="member">gui_signals</ref>,<sp/><ref refid="classopenage_1_1job_1_1_job" kindref="compound">job::Job&lt;bool&gt;</ref>{});</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>spec_and_job_ptr<sp/>=<sp/>std::make_shared&lt;decltype(spec_and_job)&gt;(spec_and_job);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>lambda<sp/>to<sp/>be<sp/>executed<sp/>to<sp/>actually<sp/>load<sp/>the<sp/>data<sp/>files.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>perform_load<sp/>=<sp/>[spec_and_job_ptr]<sp/>{</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::get&lt;std::shared_ptr&lt;GameSpec&gt;&gt;(*spec_and_job_ptr)-&gt;initialize();</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="520"><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>load_finished<sp/>=<sp/>[gui_signals_ptr<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a05d8b8251196b389e267b646e6356526" kindref="member">gui_signals</ref>.get()]<sp/>(<ref refid="namespaceopenage_1_1job_1aa7f614139b9f8585d91285475c260c2f" kindref="member">job::result_function_t&lt;bool&gt;</ref><sp/><ref refid="namespaceopenage_1_1testing_1_1testing_1ac25bf81db406af62d08113ef7ae9fd6e" kindref="member">result</ref>)<sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>load_ok;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>load_ok<sp/>=<sp/><ref refid="namespaceopenage_1_1testing_1_1testing_1ac25bf81db406af62d08113ef7ae9fd6e" kindref="member">result</ref>();</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(<ref refid="classopenage_1_1error_1_1_error" kindref="compound">Error</ref><sp/>&amp;)<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>display<sp/>that<sp/>error<sp/>in<sp/>the<sp/>ui.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(std::exception<sp/>&amp;)<sp/>{</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>\todo<sp/>same<sp/>here.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1error_1_1_error" kindref="compound">Error</ref>{<ref refid="message_8h_1a735563036dced0b7d6cc98f97ea4978b" kindref="member">ERR</ref><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;gamespec<sp/>loading<sp/>failed!&quot;</highlight><highlight class="normal">};</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(load_ok)<sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>send<sp/>the<sp/>signal<sp/>that<sp/>the<sp/>load<sp/>job<sp/>was<sp/>finished</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>emit<sp/>gui_signals_ptr-&gt;load_job_finished();</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classopenage_1_1job_1_1_job_manager" kindref="compound">job::JobManager</ref><sp/>*job_mgr<sp/>=<sp/>this-&gt;<ref refid="classopenage_1_1_game_spec_handle_1a874f61fef1e91022de73339303291d0a" kindref="member">asset_manager</ref>-&gt;<ref refid="classopenage_1_1_asset_manager_1a50069b4b3cd4b5fcf8fb5f4b480c721d" kindref="member">get_engine</ref>()-&gt;<ref refid="classopenage_1_1_engine_1a65102655ef3f9fb0fc8617deb7e80c02" kindref="member">get_job_manager</ref>();</highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/>std::get&lt;job::Job&lt;bool&gt;&gt;(*spec_and_job_ptr)<sp/>=<sp/>job_mgr-&gt;<ref refid="classopenage_1_1job_1_1_job_manager_1ab12ca59d9b54653a1106a405a23721b2" kindref="member">enqueue</ref>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal">&gt;(</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>perform_load,<sp/>load_finished</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="546"><highlight class="normal">}</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>openage</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="C:/Users/Jameson/Documents/git-projects/openage/libopenage/gamestate/game_spec.cpp"/>
  </compounddef>
</doxygen>
