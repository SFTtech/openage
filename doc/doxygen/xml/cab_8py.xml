<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.15">
  <compounddef id="cab_8py" kind="file" language="Python">
    <compoundname>cab.py</compoundname>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags" prot="public">openage::cabextract::cab::CFHeaderFlags</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header" prot="public">openage::cabextract::cab::CFHeader</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields" prot="public">openage::cabextract::cab::CFHeaderReservedFields</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder" prot="public">openage::cabextract::cab::CFFolder</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes" prot="public">openage::cabextract::cab::CFFileAttributes</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file" prot="public">openage::cabextract::cab::CFFile</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data" prot="public">openage::cabextract::cab::CFData</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file" prot="public">openage::cabextract::cab::CABFile</innerclass>
    <innerclass refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream" prot="public">openage::cabextract::cab::CABFolderStream</innerclass>
    <innernamespace refid="namespaceopenage_1_1cabextract_1_1cab">openage::cabextract::cab</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespaceopenage_1_1cabextract_1_1cab" refkind="compound"><highlight class="comment">#<sp/>Copyright<sp/>2015-2018<sp/>the<sp/>openage<sp/>authors.<sp/>See<sp/>copying.md<sp/>for<sp/>legal<sp/>info.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral">Provides<sp/>CABFile,<sp/>an<sp/>extractor<sp/>for<sp/>the<sp/>MSCAB<sp/>format.</highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral">Struct<sp/>definitions<sp/>are<sp/>according<sp/>to<sp/>the<sp/>documentation<sp/>at</highlight></codeline>
<codeline lineno="7"><highlight class="stringliteral">https://msdn.microsoft.com/en-us/library/bb417343.aspx.</highlight></codeline>
<codeline lineno="8"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>bisect<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>bisect</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>collections<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>OrderedDict</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>calendar<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>timegm</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..log<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>dbg</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.filelike.readonly<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>PosSavingReadOnlyFileLikeObject</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.filelike.stream<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>StreamFragment</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.files<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>read_guaranteed,<sp/>read_nullterminated_string</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.fslike.filecollection<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>FileCollection</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.math<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>INF</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.strings<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>try_decode</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.struct<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>NamedStruct,<sp/>Flags</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.cabchecksum<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>mscab_csum</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags" kindref="compound">CFHeaderFlags</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_flags" kindref="compound">Flags</ref>):</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Cabinet<sp/>file<sp/>option<sp/>indicators.<sp/>Found<sp/>in<sp/>the<sp/>header.<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/>specstr<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags_1a97bbf8a98680d55c080b914afcbd23ae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>this<sp/>cabfile<sp/>is<sp/>not<sp/>the<sp/>first<sp/>of<sp/>the<sp/>set.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>prev_cab<sp/>and<sp/>prev_disk<sp/>are<sp/>present<sp/>after<sp/>the<sp/>header.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_cabinet<sp/><sp/><sp/><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags_1ab77509aed873d93d9e6e09b9252dcbb9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>this<sp/>cabfile<sp/>is<sp/>not<sp/>the<sp/>last<sp/>of<sp/>the<sp/>set.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>next_cab<sp/>and<sp/>next_disk<sp/>are<sp/>present<sp/>after<sp/>the<sp/>header.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>next_cabinet<sp/><sp/><sp/><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags_1ac8abf71f12c01350c7180d4d802b9b24" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>this<sp/>cabinet<sp/>file<sp/>has<sp/>reserved<sp/>fields.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>cbCFHeader,<sp/>cbCFFolder,<sp/>and<sp/>cbCFData<sp/>are<sp/>present<sp/>after<sp/>the<sp/>header,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>followed<sp/>by<sp/>cbCFHeader<sp/>bytes<sp/>of<sp/>reserved<sp/>data.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>false,<sp/>cbCFHeader,<sp/>cbCFFolder,<sp/>and<sp/>cbCFData<sp/>default<sp/>to<sp/>0.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>reserve_present<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_flags_1a77f67a1a75a20b56ceb8cd4f99d834af" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header" kindref="compound">CFHeader</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_named_struct" kindref="compound">NamedStruct</ref>):</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Global<sp/>CAB<sp/>file<sp/>header;<sp/>found<sp/>at<sp/>the<sp/>very<sp/>beginning<sp/>of<sp/>the<sp/>file.<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>endianness<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a0fae2802d1d6210f754dc967ed76983b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>signature<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;4s&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>magic<sp/>number:<sp/>MSCF</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a46b220c68b55e2db7fd1add95da3723b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>cbCabinet<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>size<sp/>of<sp/>this<sp/>cabinet<sp/>file<sp/>in<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1ad336dbf8a6abf1ffce789c055fac8792" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1aa072a82c5202e59b399142007742fd7e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>coffFiles<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>absolute<sp/>offset<sp/>of<sp/>the<sp/>first<sp/>CFFILE<sp/>entry</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a83d5ef7772ef263b0dceaa5f0bc96f4a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved3<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a5da4685a1cfdfb6e6887bb4fefe27b88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>versionMinor<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;B&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>cab<sp/>file<sp/>format<sp/>version<sp/>(minor)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a9ac1adf5ddd511ffde4044e874dc52c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>versionMajor<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;B&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>cab<sp/>file<sp/>format<sp/>version<sp/>(major)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1af9b2b9ce4c2b3a2c960ff510a588dabd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>cFolders<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>number<sp/>of<sp/>CFFOLDER<sp/>entries<sp/>in<sp/>this<sp/>cabinet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a0ac18ae0b6533c8aa926043d66f62677" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>cFiles<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>number<sp/>of<sp/>CFFILES<sp/>entries<sp/>in<sp/>this<sp/>cabinet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a8953e398dcd0bfc451afdf38f19aeb65" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>flags<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>CFHeaderFlags</highlight></codeline>
<codeline lineno="66" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1afa70dbd6bce77e5d48a31bb6bc61f172" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>setID<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>must<sp/>be<sp/>same<sp/>in<sp/>all<sp/>cabinets<sp/>of<sp/>a<sp/>set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1ae6ffe2c9274913f226753946e196db10" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>iCabinet<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>number<sp/>of<sp/>this<sp/>cabinet<sp/>file<sp/>in<sp/>the<sp/>set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a42ecb54854e072dcb7c2f136390f3f5b" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a6591f3ad7aceb3d102dcf065709f8d41" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>those<sp/>fields<sp/>are<sp/>set<sp/>manually<sp/>later.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved_data<sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>CFHeaderReservedFields</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a8eeeaffb6cfb06eda4ecef177a003e85" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>bytes<sp/>object<sp/>of<sp/>size<sp/>reserved_data.cbCFHeader</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1afa3c8a76c610152c79a2d5fcd490e887" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>strings<sp/>that<sp/>hold<sp/>the<sp/>disk<sp/>labels/file<sp/>names<sp/>where<sp/>to<sp/>find<sp/>the<sp/>prev/next</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>CAB<sp/>files.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_cab<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_disk<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1ab320cc56c3342de4f3e560181f894b3a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>next_cab<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a4f3dbfb81fd4057009b154f5e8702bbd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>next_disk<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1aae31e7f0e1e879815bb6a3c253cc87c3" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_1a83c3a4398357347ce07c1a9206edd992" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields" kindref="compound">CFHeaderReservedFields</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_named_struct" kindref="compound">NamedStruct</ref>):</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="84"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Optionally<sp/>found<sp/>after<sp/>the<sp/>header.</highlight></codeline>
<codeline lineno="85"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>fields<sp/>indicate<sp/>the<sp/>size<sp/>of<sp/>the<sp/>reserved<sp/>data<sp/>blocks<sp/>in<sp/>the<sp/>header,</highlight></codeline>
<codeline lineno="86"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>folder<sp/>and<sp/>data<sp/>structs.</highlight></codeline>
<codeline lineno="87"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>endianness<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields_1a5c600ae58c2fb06a3737610343b3b5a7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>cbCFHeader<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>size<sp/>of<sp/>per-cabinet<sp/>reserved<sp/>area</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/>cbCFFolder<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;B&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>size<sp/>of<sp/>per-folder<sp/>reserved<sp/>area</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields_1a68fc829b63f93d471aaa48729b63b38c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>cbCFData<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;B&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>size<sp/>of<sp/>per-datablock<sp/>reserved<sp/>area</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields_1a7bee3f6defca2383a29b19e1aa07b482" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_header_reserved_fields_1abc87ad7f664d694d766f25a263c4fa35" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder" kindref="compound">CFFolder</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_named_struct" kindref="compound">NamedStruct</ref>):</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>CAB<sp/>folder<sp/>header;<sp/>A<sp/>CAB<sp/>folder<sp/>is<sp/>a<sp/>data<sp/>stream<sp/>consisting<sp/>of</highlight></codeline>
<codeline lineno="101"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>(compressed)<sp/>concatenated<sp/>file<sp/>contents.</highlight></codeline>
<codeline lineno="102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>endianness<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1a9b87f4c24e5fe07a3a94aec623f022c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>coffCabStart<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>offset<sp/>of<sp/>first<sp/>CFDATA<sp/>block<sp/>of<sp/>this<sp/>folder.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>cCFData<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>number<sp/>of<sp/>CFDATA<sp/>blocks.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1ac93f8239586ba996b7d3ca56f07d5866" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1a3876f8ccb66be642aa9f7cd71714f1bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>typeCompress<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>compression<sp/>algorithm<sp/>for<sp/>this<sp/>folder.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1a79a5f1664d4c9eea010162562b7fc8c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>filled<sp/>in<sp/>later<sp/>manually</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>bytes<sp/>object<sp/>of<sp/>size<sp/>reserved_data.cbCFFolder</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1a5b3c67d52ca76502bba9c44a58e32c32" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>comp_name<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>human-readable<sp/>compression<sp/>name</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>plain_stream<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>file-like<sp/>object<sp/>for<sp/>decompressed<sp/>folder.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1a20ae6f95165d4611d2fd0ac3355f32d5" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="119" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_folder_1aa1c36276f8bf4f5cda8e54b66d4b8935" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes" kindref="compound">CFFileAttributes</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_flags" kindref="compound">Flags</ref>):</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="122"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>File<sp/>flags;<sp/>found<sp/>in<sp/>the<sp/>CFFile<sp/>struct.</highlight></codeline>
<codeline lineno="123"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>specstr<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1a623814550c7b9def58a4e7eeffc47002" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>rdonly<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read-only</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>hidden<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>1<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>hidden</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1a1b12130b61e2d9564bd71e99f3579e3d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>system<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>2<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>system<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1ab31a2d3d219a41416a914366158e1f36" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>arch<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>5<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>archive<sp/>flag:<sp/>modified<sp/>since<sp/>last<sp/>backup</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1a247792258d5dd7dd71a72f08044ef57f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>exec<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>6<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>run<sp/>file<sp/>after<sp/>extraction<sp/>(lol,<sp/>we<sp/>won&apos;t.)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1a470d81d3f362fa438b997837aaac4d48" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>name_is_utf<sp/><sp/><sp/><sp/><sp/>=<sp/>7<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>name<sp/>is<sp/>UTF-8,<sp/>not<sp/>&quot;current<sp/>locale&quot;<sp/>(8859-1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1a88d87fd0fca62b59ef30664e7a744eee" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_attributes_1ab59fb41d11d58c7831bc94cfe9cca82e" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file" kindref="compound">CFFile</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_named_struct" kindref="compound">NamedStruct</ref>):</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="139"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Header<sp/>for<sp/>a<sp/>single<sp/>file.</highlight></codeline>
<codeline lineno="140"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="141"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Describes<sp/>the<sp/>file&apos;s<sp/>metadata,</highlight></codeline>
<codeline lineno="142"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>as<sp/>well<sp/>as<sp/>the<sp/>location<sp/>of<sp/>its<sp/>content<sp/>(which<sp/>CAB<sp/>folder,<sp/>at<sp/>what<sp/>offset).</highlight></codeline>
<codeline lineno="143"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>endianness<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a277af280273bdb545ee4c72fee345b6d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>size<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>uncompressed<sp/>filesize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>pos<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>offset<sp/>of<sp/>file<sp/>in<sp/>uncompressed<sp/>folder</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a8a297a8b66c23a207b305333c3963246" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="152" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a255f4e7a8e4b5559a4a6471d8d679483" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>index<sp/>of<sp/>the<sp/>folder<sp/>that<sp/>contains<sp/>this<sp/>file.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>there<sp/>are<sp/>several<sp/>reserved<sp/>indices<sp/>with<sp/>special<sp/>meanings:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/>0xFFFD<sp/>continued_from_prev<sp/><sp/><sp/><sp/><sp/><sp/><sp/>(acutal<sp/>id:<sp/>0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/>0xFFFE<sp/>continued_to_next<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(acutal<sp/>id:<sp/>last)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/>0xFFFF<sp/>continued_prev_and_next:<sp/><sp/>(actual<sp/>id:<sp/>0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>folderid<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a4db273d450adf8a947c534523d6cfc55" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>date<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>date<sp/>stamp<sp/>((y–1980)<sp/>&lt;&lt;<sp/>9)+(m<sp/>&lt;&lt;<sp/>5)+(d)<sp/>wtf.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>time<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>time<sp/>stamp<sp/>(h<sp/>&lt;&lt;<sp/>11)+(m<sp/>&lt;&lt;<sp/>5)+(s<sp/>&gt;&gt;<sp/>1)<sp/>røfl.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1ac3598d89b5d7d19d63ecaf725a86d521" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>attribs<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>CFFileAttributes</highlight></codeline>
<codeline lineno="163" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1ae692fcc6ff0c0f58120a8a5ea4ae615e" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="164" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1aa6df4398a9d86a4b37cbe55daac53e99" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>filled<sp/>in<sp/>later<sp/>manually</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>path<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>array<sp/>of<sp/>path<sp/>parts</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a28a782f1904cfb1a2e80bd141622b841" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>continued<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>file<sp/>continued<sp/>from<sp/>previous<sp/>CAB<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>continues<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>file<sp/>continues<sp/>in<sp/>next<sp/>CAB<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a3de5f0c9bb5cbeb91584e12a9acf04bb" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="170" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1a452e47b0f3678170ea7c143ad77d5cb3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>folder<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>CFFolder<sp/>object<sp/>for<sp/>folderid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1af39ef57af1d317163832ad53217eec87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>timestamp<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>UNIX<sp/>timestamp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_file_1aee0cee041469575d6ab2e1b6ff16d65d" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data" kindref="compound">CFData</ref>(<ref refid="classopenage_1_1util_1_1struct_1_1_named_struct" kindref="compound">NamedStruct</ref>):</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="177"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>CAB<sp/>folders<sp/>are<sp/>concatenations<sp/>of<sp/>data<sp/>blocks;<sp/>this<sp/>is<sp/>the<sp/>header</highlight></codeline>
<codeline lineno="178"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>one<sp/>such<sp/>data<sp/>block.</highlight></codeline>
<codeline lineno="179"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pylint:<sp/>disable=bad-whitespace,too-few-public-methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>endianness<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a1778f2cb2885623287a6ad9968988894" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>csum<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;I&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>checksum<sp/>of<sp/>this<sp/>block<sp/>(cbData<sp/>through<sp/>payload)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>cbData<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>number<sp/>of<sp/>compressed<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a4b6cb0b930c747f19ae37dd60a40245b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>cbUncomp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;H&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>number<sp/>of<sp/>uncompressed<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a2807d2668e854a721f2b1d178f51d36a" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="189" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1aad6bae293abe179fe2647f8e11377bcb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>filled<sp/>in<sp/>later<sp/>manually</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>reserved<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>bytes<sp/>object<sp/>of<sp/>size<sp/>reserved_data.cbCFData</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/>payload<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>compressed<sp/>folder<sp/>stream<sp/>data<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a2a6b3a28d3cd1fce8942a4435ceb2adc" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="193" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1ab870da7d8aeecc138fdb6f0ed82772c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1aed8c16e72562ec22867cd4bb429136bb" kindref="member">verify_checksum</ref>(self):</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="195"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Checks<sp/>whether<sp/>csum<sp/>contains<sp/>the<sp/>correct<sp/>checksum<sp/>for<sp/>the<sp/>block.</highlight></codeline>
<codeline lineno="196"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raises<sp/>ValueError<sp/>otherwise.</highlight></codeline>
<codeline lineno="197"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>first<sp/>part<sp/>of<sp/>the<sp/>checksum<sp/>is<sp/>simply<sp/>the<sp/>checksum<sp/>of<sp/>cbData<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199" refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1aed8c16e72562ec22867cd4bb429136bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>cbUncomp,<sp/>which<sp/>is<sp/>simply<sp/>the<sp/>little-endian<sp/>value<sp/>of<sp/>their</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>concatenation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>=<sp/>(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1aad6bae293abe179fe2647f8e11377bcb" kindref="member">cbUncomp</ref><sp/>&lt;&lt;<sp/>16)<sp/>|<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a2807d2668e854a721f2b1d178f51d36a" kindref="member">cbData</ref></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>next<sp/>part<sp/>of<sp/>the<sp/>checksum<sp/>is<sp/>from<sp/>reserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a2a6b3a28d3cd1fce8942a4435ceb2adc" kindref="member">reserved</ref>:</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>^=<sp/>mscab_csum(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a2a6b3a28d3cd1fce8942a4435ceb2adc" kindref="member">reserved</ref>)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>final<sp/>part<sp/>is<sp/>from<sp/>the<sp/>actual<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum<sp/>^=<sp/>mscab_csum(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1ab870da7d8aeecc138fdb6f0ed82772c8" kindref="member">payload</ref>)</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>checksum<sp/>!=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_f_data_1a4b6cb0b930c747f19ae37dd60a40245b" kindref="member">csum</ref>:</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;checksum<sp/>error<sp/>in<sp/>MSCAB<sp/>data<sp/>block&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file" kindref="compound">CABFile</ref>(<ref refid="classopenage_1_1util_1_1fslike_1_1filecollection_1_1_file_collection" kindref="compound">FileCollection</ref>):</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>actual<sp/>file<sp/>system-like<sp/>CAB<sp/>object.</highlight></codeline>
<codeline lineno="217"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Constructor<sp/>arguments:</highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>@param<sp/>cab:</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>file-like<sp/>object<sp/>that<sp/>must<sp/>implement<sp/>read()<sp/>and<sp/>seek()<sp/>with</highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whence=os.SEEK_SET.</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>constructor<sp/>reads<sp/>the<sp/>entire<sp/>header,<sp/>including<sp/>the<sp/>folder<sp/>and<sp/>file</highlight></codeline>
<codeline lineno="225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>descriptions.<sp/>Most<sp/>CAB<sp/>file<sp/>issues<sp/>should<sp/>cause<sp/>the<sp/>constructor<sp/>to<sp/>fail.</highlight></codeline>
<codeline lineno="226"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1util_1_1struct_1_1_named_struct_1a73bebaa3ad9fc8839af4f542b842e61c" kindref="member">__init__</ref>(self,<sp/>cab):</highlight></codeline>
<codeline lineno="228" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1a17b11fd7e416e7e4bac798af10470d54" kindref="member">__init__</ref>()</highlight></codeline>
<codeline lineno="229" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1a17b11fd7e416e7e4bac798af10470d54" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>header</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cab.seek(0)</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>CFHeader.read(cab)</highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>verify<sp/>magic<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>header.signature<sp/>!=<sp/>b</highlight><highlight class="stringliteral">&quot;MSCF&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>Exception(</highlight><highlight class="stringliteral">&quot;invalid<sp/>CAB<sp/>file<sp/>signature:<sp/>&quot;</highlight><highlight class="normal"><sp/>+</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1util_1a7bc4421a5f0f57f3a0aba3f96eb8d19c" kindref="member">repr</ref>(header.signature))</highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>reserve<sp/>header,<sp/>if<sp/>present</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>header.flags.reserve_present:</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.reserved_data<sp/>=<sp/>CFHeaderReservedFields.read(cab)</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.reserved_data<sp/>=<sp/>CFHeaderReservedFields.from_nullbytes()</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>reserved</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.reserved<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1files_1aa2ba5a14f2468fd0745e07dc84ff2188" kindref="member">read_guaranteed</ref>(cab,<sp/>header.reserved_data.cbCFHeader)</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>previous<sp/>cabinet<sp/>info</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>header.flags.prev_cabinet:</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.prev_cab<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1strings_1a2326b323f70b3a792727afcf330b38fe" kindref="member">try_decode</ref>(<ref refid="namespaceopenage_1_1util_1_1files_1a648056f11b83f759c99f551f483e9bef" kindref="member">read_nullterminated_string</ref>(cab))</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.prev_disk<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1strings_1a2326b323f70b3a792727afcf330b38fe" kindref="member">try_decode</ref>(<ref refid="namespaceopenage_1_1util_1_1files_1a648056f11b83f759c99f551f483e9bef" kindref="member">read_nullterminated_string</ref>(cab))</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>next<sp/>cabinet<sp/>info</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>header.flags.next_cabinet:</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.next_cab<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1strings_1a2326b323f70b3a792727afcf330b38fe" kindref="member">try_decode</ref>(<ref refid="namespaceopenage_1_1util_1_1files_1a648056f11b83f759c99f551f483e9bef" kindref="member">read_nullterminated_string</ref>(cab))</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header.next_disk<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1strings_1a2326b323f70b3a792727afcf330b38fe" kindref="member">try_decode</ref>(<ref refid="namespaceopenage_1_1util_1_1files_1a648056f11b83f759c99f551f483e9bef" kindref="member">read_nullterminated_string</ref>(cab))</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>(header)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref><sp/>=<sp/>header</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1af0314a42b04e3b0f18cdfa33f8d6094d" kindref="member">folders</ref><sp/>=<sp/>tuple(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1a4d9e75ec517f4c47627143b3a950a7e7" kindref="member">read_folder_headers</ref>(cab))</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1af0314a42b04e3b0f18cdfa33f8d6094d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>{filename:<sp/>fileobj},<sp/>{subdirname:<sp/>subdir}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1aff692dacfa2d9820e9d504cccd433252" kindref="member">rootdir</ref><sp/>=<sp/>OrderedDict(),<sp/>OrderedDict()</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1aff692dacfa2d9820e9d504cccd433252" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>fileobj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ade45243e5c507f83f57d2ca5ad6a27e8" kindref="member">read_file_headers</ref>(cab):</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopenage_1_1util_1_1fslike_1_1abstract_1_1_f_s_like_object_1af973fe09db18f1f04474fab94da350c5" kindref="member">is_file</ref>(fileobj.path)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classopenage_1_1util_1_1fslike_1_1abstract_1_1_f_s_like_object_1a336d8d1597189253f24703641c7fd436" kindref="member">is_dir</ref>(fileobj.path):</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CABFile<sp/>has<sp/>multiple<sp/>entries<sp/>with<sp/>the<sp/>same<sp/>path:<sp/>&quot;</highlight><highlight class="normal"><sp/>+</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">.join(fileobj.path).decode())</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1util_1_1fslike_1_1filecollection_1_1_file_collection_1aa7aa810fd31b2ab2290b57b3c8c3c123" kindref="member">open_r</ref>(fileobj=fileobj):</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Returns<sp/>a<sp/>opened<sp/>(&apos;rb&apos;)<sp/>file-like<sp/>object<sp/>for<sp/>fileobj.<sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classopenage_1_1util_1_1filelike_1_1stream_1_1_stream_fragment" kindref="compound">StreamFragment</ref>(</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.folder.plain_stream,</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.pos,</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.size</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1util_1_1fslike_1_1filecollection_1_1_file_collection_1a28fd0619554d60027e2e2bf0568e2d4c" kindref="member">add_fileentry</ref>(fileobj.path,<sp/>(</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>open_r,</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fileobj=fileobj:<sp/>fileobj.size,</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fileobj=fileobj:<sp/>fileobj.timestamp</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>))</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1af95f1dfaff43544d8b0316c3ceed03bc" kindref="member">__repr__</ref>(self):</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;CABFile&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1af95f1dfaff43544d8b0316c3ceed03bc" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1a4d9e75ec517f4c47627143b3a950a7e7" kindref="member">read_folder_headers</ref>(self,<sp/>cab):</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="292"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Called<sp/>during<sp/>the<sp/>constructor<sp/>run.</highlight></codeline>
<codeline lineno="293"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="294"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reads<sp/>the<sp/>folder<sp/>headers<sp/>and<sp/>initializes<sp/>the<sp/>folder&apos;s<sp/>plain<sp/>stream</highlight></codeline>
<codeline lineno="295"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file-like<sp/>objects.</highlight></codeline>
<codeline lineno="296"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="297"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Yields<sp/>all<sp/>folders.</highlight></codeline>
<codeline lineno="298"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>folder<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1a4d9e75ec517f4c47627143b3a950a7e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref>.cFolders):</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder<sp/>=<sp/>CFFolder.read(cab)</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>reserved</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.reserved<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1files_1aa2ba5a14f2468fd0745e07dc84ff2188" kindref="member">read_guaranteed</ref>(</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cab,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref>.reserved_data.cbCFFolder)</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>create<sp/>compressed<sp/>data<sp/>stream</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compressed_data_stream<sp/>=<sp/><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream" kindref="compound">CABFolderStream</ref>(</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cab,</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.coffCabStart,</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.cCFData,</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref>.reserved_data.cbCFData)</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>determine<sp/>compression<sp/>type<sp/>and<sp/>create<sp/>plain<sp/>data<sp/>stream</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compression_type<sp/>=<sp/>folder.typeCompress<sp/>&amp;<sp/>0x000f</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>compression_type<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.comp_name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Plain&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.plain_stream<sp/>=<sp/>compressed_data_stream</highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>compression_type<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>Exception(</highlight><highlight class="stringliteral">&quot;MSZIP<sp/>compression<sp/>is<sp/>unsupported&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>compression_type<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>Exception(</highlight><highlight class="stringliteral">&quot;Quantum<sp/>compression<sp/>is<sp/>unsupported&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>compression_type<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_bits<sp/>=<sp/>(folder.typeCompress<sp/>&gt;&gt;<sp/>8)<sp/>&amp;<sp/>0x1f</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.comp_name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;LZX<sp/>(window_bits<sp/>=<sp/>%d)&quot;</highlight><highlight class="normal"><sp/>%<sp/>window_bits</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.lzxdstream<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>LZXDStream</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>..util.filelike.stream<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>StreamSeekBuffer</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unseekable_plain_stream<sp/>=<sp/>LZXDStream(</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compressed_data_stream,</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_bits=window_bits,</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reset_interval=0)</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>folder.plain_stream<sp/>=<sp/>StreamSeekBuffer(unseekable_plain_stream)</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>Exception(</highlight><highlight class="stringliteral">&quot;Unknown<sp/>compression<sp/>type<sp/>%d&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>compression_type)</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>(folder)</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>folder</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ade45243e5c507f83f57d2ca5ad6a27e8" kindref="member">read_file_headers</ref>(self,<sp/>cab):</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="351"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Called<sp/>during<sp/>the<sp/>constructor<sp/>run.</highlight></codeline>
<codeline lineno="352"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="353"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reads<sp/>the<sp/>headers<sp/>for<sp/>all<sp/>files<sp/>and<sp/>yields<sp/>CFFile<sp/>objects.</highlight></codeline>
<codeline lineno="354"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seek<sp/>to<sp/>the<sp/>correct<sp/>position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ade45243e5c507f83f57d2ca5ad6a27e8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>cab.tell()<sp/>!=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref>.coffFiles:</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cab.seek(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref>.coffFiles)</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceopenage_1_1log_1aad3d76b2466dbc4f81552935f2d84faa" kindref="member">dbg</ref>(</highlight><highlight class="stringliteral">&quot;cabfile<sp/>has<sp/>nonstandard<sp/>format:<sp/>seek<sp/>to<sp/>header.coffFiles<sp/>was<sp/>required&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1ae55c1f7f103006992ff6a29e92af5d6d" kindref="member">header</ref>.cFiles):</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj<sp/>=<sp/>CFFile.read(cab)</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>filename</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rpath<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1files_1a648056f11b83f759c99f551f483e9bef" kindref="member">read_nullterminated_string</ref>(cab)</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>decode<sp/>filename<sp/>according<sp/>to<sp/>flags</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>fileobj.attribs.name_is_utf:</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/>rpath.decode(</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/>rpath.decode(</highlight><highlight class="stringliteral">&apos;iso-8859-1&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.path<sp/>=<sp/>path.replace(</highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">).lower().encode().<ref refid="namespaceopenage_1_1util_1a9556b8562574e2c6ad102d8fd87569c6" kindref="member">split</ref>(b</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>interpret<sp/>the<sp/>special<sp/>values<sp/>of<sp/>folderid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>fileobj.folderid<sp/>==<sp/>0xFFFD:</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.folderid<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.continued<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>fileobj.folderid<sp/>==<sp/>0xFFFE:</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.folderid<sp/>=<sp/>len(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1af0314a42b04e3b0f18cdfa33f8d6094d" kindref="member">folders</ref>)<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.continues<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>fileobj.folderid<sp/>==<sp/>0xFFFF:</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.folderid<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.continued<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.continues<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.folder<sp/>=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_file_1af0314a42b04e3b0f18cdfa33f8d6094d" kindref="member">folders</ref>[fileobj.folderid]</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>decode<sp/>file<sp/>timestamp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>beware:<sp/>reading<sp/>this<sp/>may<sp/>give<sp/>you<sp/>internal<sp/>bleedings.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>year<sp/>=<sp/>(fileobj.date<sp/>&gt;&gt;<sp/>9)<sp/>+<sp/>1980</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>month<sp/>=<sp/>(fileobj.date<sp/>&gt;&gt;<sp/>5)<sp/>&amp;<sp/>0x000f</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>day<sp/>=<sp/>(fileobj.date<sp/>&gt;&gt;<sp/>0)<sp/>&amp;<sp/>0x001f</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>it&apos;s<sp/>sort<sp/>of<sp/>sad<sp/>that<sp/>there&apos;s<sp/>no<sp/>bit<sp/>for<sp/>AM/PM.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hour<sp/>=<sp/>(fileobj.time<sp/>&gt;&gt;<sp/>11)</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minute<sp/>=<sp/>(fileobj.time<sp/>&gt;&gt;<sp/>5)<sp/>&amp;<sp/>0x003f</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sec<sp/>=<sp/>(fileobj.time<sp/>&lt;&lt;<sp/>1)<sp/>&amp;<sp/>0x003f</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>CAB<sp/>files<sp/>have<sp/>no<sp/>timezone<sp/>info;<sp/>assume<sp/>UTC.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileobj.timestamp<sp/>=<sp/>timegm((year,<sp/>month,<sp/>day,<sp/>hour,<sp/>minute,<sp/>sec))</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>fileobj</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream" kindref="compound">CABFolderStream</ref>(<ref refid="classopenage_1_1util_1_1filelike_1_1readonly_1_1_pos_saving_read_only_file_like_object" kindref="compound">PosSavingReadOnlyFileLikeObject</ref>):</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="407"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Read-only,<sp/>seekable,<sp/>file-like<sp/>stream<sp/>object<sp/>that<sp/>represents</highlight></codeline>
<codeline lineno="408"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>compressed<sp/>MSCAB<sp/>folder<sp/>(MSCAB<sp/>folders<sp/>are<sp/>just<sp/>compressed<sp/>streams</highlight></codeline>
<codeline lineno="409"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>concatenated<sp/>file<sp/>contents,<sp/>and<sp/>are<sp/>not<sp/>to<sp/>be<sp/>confused<sp/>with<sp/>file<sp/>system</highlight></codeline>
<codeline lineno="410"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>folders).</highlight></codeline>
<codeline lineno="411"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="412"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Constructor<sp/>arguments:</highlight></codeline>
<codeline lineno="413"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="414"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>@param<sp/>fileobj:</highlight></codeline>
<codeline lineno="415"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Seekable<sp/>file-like<sp/>object<sp/>that<sp/>represents<sp/>the<sp/>CAB<sp/>file.</highlight></codeline>
<codeline lineno="416"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="417"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CABFolderStream<sp/>explicitly<sp/>positions<sp/>the<sp/>file<sp/>cursor<sp/>before<sp/>every<sp/>read;</highlight></codeline>
<codeline lineno="418"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>is<sp/>to<sp/>make<sp/>sure<sp/>that<sp/>multiple<sp/>CABFolderStreams<sp/>can<sp/>work<sp/>on<sp/>the</highlight></codeline>
<codeline lineno="419"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>same<sp/>file,<sp/>in<sp/>parallel.</highlight></codeline>
<codeline lineno="420"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="421"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>file<sp/>object<sp/>must<sp/>implement<sp/>read()<sp/>and<sp/>seek()<sp/>with<sp/>SEEK_SET.</highlight></codeline>
<codeline lineno="422"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="423"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>@param<sp/>offset:</highlight></codeline>
<codeline lineno="424"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Offset<sp/>of<sp/>the<sp/>first<sp/>of<sp/>the<sp/>folder&apos;s<sp/>data<sp/>blocks<sp/>in<sp/>the<sp/>CAB<sp/>file.</highlight></codeline>
<codeline lineno="425"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="426"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>@param<sp/>blockcount:</highlight></codeline>
<codeline lineno="427"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Number<sp/>of<sp/>data<sp/>blocks<sp/>in<sp/>the<sp/>folder.</highlight></codeline>
<codeline lineno="428"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa7cd2f218913d84d5318d4c9f1e76884" kindref="member">__init__</ref>(self,<sp/>fileobj,<sp/>offset,<sp/>blockcount,<sp/>blockreserved):</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa7cd2f218913d84d5318d4c9f1e76884" kindref="member">__init__</ref>()</highlight></codeline>
<codeline lineno="432" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa7cd2f218913d84d5318d4c9f1e76884" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref><sp/>=<sp/>fileobj</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1affe5dcb69686e8b8963f29256df98348" kindref="member">blockcount</ref><sp/>=<sp/>blockcount</highlight></codeline>
<codeline lineno="435" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aca36850e8a35ae6d29fd7b1c1263a702" kindref="member">blockreserved</ref><sp/>=<sp/>blockreserved</highlight></codeline>
<codeline lineno="436" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1affe5dcb69686e8b8963f29256df98348" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="437" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aca36850e8a35ae6d29fd7b1c1263a702" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>positions<sp/>of<sp/>the<sp/>blocks<sp/>in<sp/>fileobj.<sp/>block<sp/>0<sp/>starts<sp/>at<sp/>offset.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref><sp/>=<sp/>[offset]</highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight></codeline>
<codeline lineno="440" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>positions<sp/>in<sp/>the<sp/>stream<sp/>of<sp/>the<sp/>start<sp/>of<sp/>each<sp/>block.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" kindref="member">streamindex</ref><sp/>=<sp/>[0]</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1adc3af5aa923ad52702de79831c669dc3" kindref="member">next_block_size</ref>(self,<sp/>payloadsize):</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="445"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>adds<sp/>metadata<sp/>for<sp/>the<sp/>next<sp/>block</highlight></codeline>
<codeline lineno="446"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>.append(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>[-1]<sp/>+</highlight></codeline>
<codeline lineno="448" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1adc3af5aa923ad52702de79831c669dc3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CFData.size()<sp/>+<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aca36850e8a35ae6d29fd7b1c1263a702" kindref="member">blockreserved</ref><sp/>+</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payloadsize)</highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" kindref="member">streamindex</ref>.append(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" kindref="member">streamindex</ref>[-1]<sp/>+<sp/>payloadsize)</highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a455bb79e71a8baa07af00ac680085f6d" kindref="member">read_block_data</ref>(self,<sp/>block_id):</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="455"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reads<sp/>the<sp/>data<sp/>of<sp/>block<sp/>block_id.</highlight></codeline>
<codeline lineno="456"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="457"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>necessary,<sp/>the<sp/>metadata<sp/>info<sp/>in<sp/>self.blockvalues<sp/>and</highlight></codeline>
<codeline lineno="458"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.blockoffsets<sp/>is<sp/>updated.</highlight></codeline>
<codeline lineno="459"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="460"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>the<sp/>block<sp/>data.</highlight></codeline>
<codeline lineno="461"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>block_id<sp/>&gt;=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1affe5dcb69686e8b8963f29256df98348" kindref="member">blockcount</ref>:</highlight></codeline>
<codeline lineno="463" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a455bb79e71a8baa07af00ac680085f6d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>EOFError()</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>block_id<sp/>&gt;=<sp/>len(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>):</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>do<sp/>not<sp/>yet<sp/>know<sp/>where<sp/>the<sp/>block<sp/>starts.<sp/>Seek<sp/>forwards.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>info<sp/>for<sp/>the<sp/>rightmost<sp/>known<sp/>block<sp/>to<sp/>get<sp/>its<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>[-1]</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref>.<ref refid="classopenage_1_1util_1_1filelike_1_1readonly_1_1_pos_saving_read_only_file_like_object_1a2312775f74be5a112a1ab18f0f581173" kindref="member">seek</ref>(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>[-1])</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datablock<sp/>=<sp/>CFData.read(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref>)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>starting<sp/>position<sp/>of<sp/>next<sp/>block<sp/>to<sp/>metadata.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1adc3af5aa923ad52702de79831c669dc3" kindref="member">next_block_size</ref>(datablock.cbData)</highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>we<sp/>now<sp/>know<sp/>the<sp/>starting<sp/>position<sp/>of<sp/>the<sp/>block.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>[block_id]</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref>.<ref refid="classopenage_1_1util_1_1filelike_1_1readonly_1_1_pos_saving_read_only_file_like_object_1a2312775f74be5a112a1ab18f0f581173" kindref="member">seek</ref>(offset)</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datablock<sp/>=<sp/>CFData.read(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref>)</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datablock.reserved<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1files_1aa2ba5a14f2468fd0745e07dc84ff2188" kindref="member">read_guaranteed</ref>(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref>,<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aca36850e8a35ae6d29fd7b1c1263a702" kindref="member">blockreserved</ref>)</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datablock.payload<sp/>=<sp/><ref refid="namespaceopenage_1_1util_1_1files_1aa2ba5a14f2468fd0745e07dc84ff2188" kindref="member">read_guaranteed</ref>(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref>,<sp/>datablock.cbData)</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>verify<sp/>the<sp/>datablock&apos;s<sp/>checksum.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>datablock.verify_checksum()</highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>starting<sp/>data<sp/>of<sp/>next<sp/>block<sp/>to<sp/>metadata,<sp/>if<sp/>required.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>block_id<sp/>+<sp/>1<sp/>==<sp/>len(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref>):</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1adc3af5aa923ad52702de79831c669dc3" kindref="member">next_block_size</ref>(datablock.cbData)</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>finally,<sp/>return<sp/>the<sp/>data.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>datablock.payload</highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ad9654069c6554f9859298fa5c1e85b73" kindref="member">read_blocks</ref>(self,<sp/>size=-1):</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="495"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Similar<sp/>to<sp/>read,<sp/>bit<sp/>instead<sp/>of<sp/>a<sp/>single<sp/>bytes<sp/>object,</highlight></codeline>
<codeline lineno="496"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>an<sp/>iterator<sp/>of<sp/>multiple<sp/>bytes<sp/>objects,<sp/>one<sp/>for<sp/>each<sp/>block.</highlight></codeline>
<codeline lineno="497"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="498"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Used<sp/>internally<sp/>be<sp/>read(),<sp/>but<sp/>you<sp/>may<sp/>use<sp/>it<sp/>directly.</highlight></codeline>
<codeline lineno="499"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>size<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="501" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ad9654069c6554f9859298fa5c1e85b73" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>INF</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>use<sp/>self.streamindex<sp/>to<sp/>determine<sp/>the<sp/>block<sp/>id<sp/>for<sp/>pos.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blockid<sp/>=<sp/>bisect(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" kindref="member">streamindex</ref>,<sp/>self.<ref refid="classopenage_1_1util_1_1filelike_1_1readonly_1_1_pos_saving_read_only_file_like_object_1af050a9db86efcd8b06fa90a57c0c7988" kindref="member">pos</ref>)<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>bytes<sp/>to<sp/>discard<sp/>(because<sp/>we&apos;re<sp/>still<sp/>reading<sp/>data<sp/>that<sp/>lie</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>before<sp/>self.pos).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discard<sp/>=<sp/>self.<ref refid="classopenage_1_1util_1_1filelike_1_1readonly_1_1_pos_saving_read_only_file_like_object_1af050a9db86efcd8b06fa90a57c0c7988" kindref="member">pos</ref><sp/>-<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" kindref="member">streamindex</ref>[blockid]</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>size<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_data<sp/>=<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a455bb79e71a8baa07af00ac680085f6d" kindref="member">read_block_data</ref>(blockid)</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>EOFError:</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blockid<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>discard<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>discard<sp/>&gt;=<sp/>len(block_data):</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>we&apos;re<sp/>actually<sp/>still<sp/>seeking<sp/>through<sp/>the<sp/>file,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>reading<sp/>it<sp/>block<sp/>by<sp/>block,<sp/>approaching<sp/>the<sp/>stream<sp/>cursor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>position.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discard<sp/>-=<sp/>len(block_data)</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>discard<sp/>the<sp/>first<sp/>few<sp/>bytes<sp/>of<sp/>the<sp/>block&apos;s<sp/>data.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_data<sp/>=<sp/>block_data[discard:]</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discard<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(block_data)<sp/>&gt;<sp/>size:</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>less<sp/>than<sp/>the<sp/>entire<sp/>block<sp/>was<sp/>requested.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_data<sp/>=<sp/>block_data[:size]</highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>-=<sp/>len(block_data)</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1util_1_1filelike_1_1readonly_1_1_pos_saving_read_only_file_like_object_1af050a9db86efcd8b06fa90a57c0c7988" kindref="member">pos</ref><sp/>+=<sp/>len(block_data)</highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>block_data</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa01e2f0b6657c5c629188cbc3a0e0a57" kindref="member">read</ref>(self,<sp/>size=-1):</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>b</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">.join(self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ad9654069c6554f9859298fa5c1e85b73" kindref="member">read_blocks</ref>(size))</highlight></codeline>
<codeline lineno="543" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa01e2f0b6657c5c629188cbc3a0e0a57" refkind="member"><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a22d3c8597d3b8ef507a98145bd623990" kindref="member">get_size</ref>(self):</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>self<sp/><sp/></highlight><highlight class="comment">#<sp/>unused</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="546" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a22d3c8597d3b8ef507a98145bd623990" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae5a7fefaa419877c7b44e69e7451c6f8" kindref="member">close</ref>(self):</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa3e35032def0fef5bca09bedb21e96e3" kindref="member">closed</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae5a7fefaa419877c7b44e69e7451c6f8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1ae0cddd916e7ff13331545f7e355ca3de" kindref="member">fileobj</ref></highlight></codeline>
<codeline lineno="551" refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1aa3e35032def0fef5bca09bedb21e96e3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a93b53ba3420a1c165c283ee91a18dd10" kindref="member">blockoffsets</ref></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>self.<ref refid="classopenage_1_1cabextract_1_1cab_1_1_c_a_b_folder_stream_1a4ad893fc5e33e9a96874d9a6fd70d8bb" kindref="member">streamindex</ref></highlight></codeline>
    </programlisting>
    <location file="C:/Users/Jameson/Documents/git-projects/openage/openage/cabextract/cab.py"/>
  </compounddef>
</doxygen>
